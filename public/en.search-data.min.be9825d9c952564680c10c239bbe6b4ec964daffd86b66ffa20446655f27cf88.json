[{"id":0,"href":"/docs/summary/aws-services-diagram/","title":"AWS Services Architecture Diagram","section":"Summary","content":"SÆ¡ Äá»“ Kiáº¿n TrÃºc Dá»‹ch Vá»¥ AWS#\rKiáº¿n TrÃºc Há»‡ Thá»‘ng#\rgraph TB\rsubgraph \u0026#34;Táº§ng Client\u0026#34;\rWebApp[Web App\u0026lt;br/\u0026gt;Next.js]\rMobileApp[Mobile App\u0026lt;br/\u0026gt;React Native - TÆ°Æ¡ng lai]\rend\rsubgraph \u0026#34;CDN \u0026amp; Hosting\u0026#34;\rCloudFront[Amazon CloudFront\u0026lt;br/\u0026gt;CDN]\rAmplify[AWS Amplify\u0026lt;br/\u0026gt;Hosting \u0026amp; CI/CD]\rend\rsubgraph \u0026#34;Táº§ng API Gateway\u0026#34;\rAPIGateway[Amazon API Gateway\u0026lt;br/\u0026gt;REST API]\rWSGateway[API Gateway\u0026lt;br/\u0026gt;WebSocket - TÆ°Æ¡ng lai]\rend\rsubgraph \u0026#34;XÃ¡c Thá»±c\u0026#34;\rCognitoUser[Amazon Cognito\u0026lt;br/\u0026gt;User Pool]\rCognitoIdentity[Cognito Identity Pool]\rend\rsubgraph \u0026#34;Táº§ng Compute\u0026#34;\rLambdaAuth[Lambda: Auth Handler\u0026lt;br/\u0026gt;Node.js 20]\rLambdaRecipe[Lambda: Recipe CRUD\u0026lt;br/\u0026gt;Node.js 20]\rLambdaAI[Lambda: AI Suggestion\u0026lt;br/\u0026gt;Node.js 20]\rLambdaProfile[Lambda: User Profile\u0026lt;br/\u0026gt;Node.js 20]\rLambdaSocial[Lambda: Social/Friends\u0026lt;br/\u0026gt;Node.js 20]\rLambdaPost[Lambda: Posts \u0026amp; Comments\u0026lt;br/\u0026gt;Node.js 20]\rLambdaNotification[Lambda: Notifications\u0026lt;br/\u0026gt;Node.js 20]\rLambdaAdmin[Lambda: Admin Operations\u0026lt;br/\u0026gt;Node.js 20]\rLambdaCooking[Lambda: Cooking History\u0026lt;br/\u0026gt;Node.js 20]\rLambdaRating[Lambda: Rating \u0026amp; Approval\u0026lt;br/\u0026gt;Node.js 20]\rLambdaIngredient[Lambda: Ingredient Validation\u0026lt;br/\u0026gt;Node.js 20]\rend\rsubgraph \u0026#34;Dá»‹ch Vá»¥ AI\u0026#34;\rBedrock[Amazon Bedrock\u0026lt;br/\u0026gt;Claude 3.5 Sonnet/Haiku]\rend\rsubgraph \u0026#34;Táº§ng Database\u0026#34;\rDynamoDB[Amazon DynamoDB\u0026lt;br/\u0026gt;\u0026lt;br/\u0026gt;Báº£ng: Users\u0026lt;br/\u0026gt;Báº£ng: UserData\u0026lt;br/\u0026gt;Báº£ng: Recipes\u0026lt;br/\u0026gt;Báº£ng: RecipeRatings\u0026lt;br/\u0026gt;Báº£ng: UserCookingHistory\u0026lt;br/\u0026gt;Báº£ng: MasterIngredients\u0026lt;br/\u0026gt;Báº£ng: AI_Suggestions\u0026lt;br/\u0026gt;Báº£ng: Privacy\u0026lt;br/\u0026gt;Báº£ng: Friendships\u0026lt;br/\u0026gt;Báº£ng: Posts\u0026lt;br/\u0026gt;Báº£ng: Comments\u0026lt;br/\u0026gt;Báº£ng: Reactions\u0026lt;br/\u0026gt;Báº£ng: Notifications]\rend\rsubgraph \u0026#34;LÆ°u Trá»¯\u0026#34;\rS3[Amazon S3\u0026lt;br/\u0026gt;User Uploads \u0026amp; Assets]\rend\rsubgraph \u0026#34;GiÃ¡m SÃ¡t \u0026amp; Logging\u0026#34;\rCloudWatch[Amazon CloudWatch\u0026lt;br/\u0026gt;Logs \u0026amp; Metrics]\rXRay[AWS X-Ray\u0026lt;br/\u0026gt;Tracing]\rend\rsubgraph \u0026#34;Báº£o Máº­t\u0026#34;\rWAF[AWS WAF\u0026lt;br/\u0026gt;Web Application Firewall]\rSecrets[AWS Secrets Manager\u0026lt;br/\u0026gt;API Keys]\rend\rWebApp --\u0026gt; CloudFront\rCloudFront --\u0026gt; Amplify\rWebApp --\u0026gt; APIGateway\rAPIGateway --\u0026gt; CognitoUser\rCognitoUser --\u0026gt; LambdaAuth\rCognitoIdentity --\u0026gt; S3\rAPIGateway --\u0026gt; LambdaRecipe\rAPIGateway --\u0026gt; LambdaAI\rAPIGateway --\u0026gt; LambdaProfile\rAPIGateway --\u0026gt; LambdaSocial\rAPIGateway --\u0026gt; LambdaPost\rAPIGateway --\u0026gt; LambdaNotification\rAPIGateway --\u0026gt; LambdaAdmin\rAPIGateway --\u0026gt; LambdaCooking\rAPIGateway --\u0026gt; LambdaRating\rAPIGateway --\u0026gt; LambdaIngredient\rLambdaAI --\u0026gt; Bedrock\rLambdaRecipe --\u0026gt; DynamoDB\rLambdaAI --\u0026gt; DynamoDB\rLambdaProfile --\u0026gt; DynamoDB\rLambdaSocial --\u0026gt; DynamoDB\rLambdaPost --\u0026gt; DynamoDB\rLambdaNotification --\u0026gt; DynamoDB\rLambdaAdmin --\u0026gt; DynamoDB\rLambdaCooking --\u0026gt; DynamoDB\rLambdaRating --\u0026gt; DynamoDB\rLambdaIngredient --\u0026gt; DynamoDB\rLambdaRecipe --\u0026gt; S3\rLambdaAuth --\u0026gt; CloudWatch\rLambdaRecipe --\u0026gt; CloudWatch\rLambdaAI --\u0026gt; CloudWatch\rLambdaCooking --\u0026gt; CloudWatch\rLambdaRating --\u0026gt; CloudWatch\rAPIGateway --\u0026gt; WAFPhÃ¢n TÃ­ch Chi Tiáº¿t CÃ¡c Dá»‹ch Vá»¥#\r1. Frontend \u0026amp; CDN#\rAWS Amplify:\nHost á»©ng dá»¥ng Node.js Pipeline CI/CD (tá»± Ä‘á»™ng deploy tá»« GitHub) Custom domain \u0026amp; SSL certificates Chi phÃ­: ~$15/thÃ¡ng Amazon CloudFront:\nCDN toÃ n cáº§u cho phÃ¢n phá»‘i ná»™i dung nhanh chÃ³ng Cache cÃ¡c static assets Chi phÃ­: ~$5-10/thÃ¡ng (1TB data transfer) 2. XÃ¡c Thá»±c \u0026amp; PhÃ¢n Quyá»n#\rAmazon Cognito User Pool:\nÄÄƒng kÃ½ \u0026amp; Ä‘Äƒng nháº­p ngÆ°á»i dÃ¹ng XÃ¡c minh email KhÃ´i phá»¥c máº­t kháº©u Há»— trá»£ MFA (tÆ°Æ¡ng lai) Chi phÃ­: MIá»„N PHÃ (\u0026lt; 50,000 ) Cognito Identity Pool:\nThÃ´ng tin xÃ¡c thá»±c AWS táº¡m thá»i Ä‘á»ƒ truy cáº­p S3 Quyá»n IAM chi tiáº¿t 3. Táº§ng API#\rAmazon API Gateway (REST):\nRESTful API endpoints Validation request Quáº£n lÃ½ API key Throttling \u0026amp; rate limiting Cáº¥u hÃ¬nh CORS Chi phÃ­: ~$3.50 trÃªn triá»‡u requests API Endpoints#\rPOST /auth/register\rPOST /auth/login\rGET /user/profile\rPUT /user/profile\rPOST /user/ingredients\rGET /user/ingredients\rDELETE /user/ingredients/{id}\rPUT /user/privacy\rGET /user/privacy\rPOST /friends/request\rGET /friends\rPUT /friends/{id}/accept\rPUT /friends/{id}/reject\rDELETE /friends/{id}\rPOST /recipes\rGET /recipes/{id}\rPUT /recipes/{id}\rDELETE /recipes/{id}\rGET /recipes/search\rPOST /recipes/{id}/rate\rPOST /ai/suggest\rGET /ai/suggestions\rPOST /ai/feedback\rPOST /cooking/start\rPUT /cooking/{id}/complete\rGET /user/cooking-history\rDELETE /cooking/{id}\rPUT /cooking/{id}/favorite\rPOST /ingredients/validate\rGET /ingredients/search\rPOST /posts\rGET /posts/{id}\rPUT /posts/{id}\rDELETE /posts/{id}\rGET /posts/feed\rGET /posts/user/{userId}\rPOST /posts/{id}/comments\rGET /posts/{id}/comments\rPUT /comments/{id}\rDELETE /comments/{id}\rPOST /reactions\rDELETE /reactions/{id}\rGET /reactions/{targetType}/{targetId}\rGET /notifications\rPUT /notifications/{id}/read\rPUT /notifications/read-all4. Lambda Functions#\rLambda 1: Auth Handler#\rRuntime: Node.js 20 Memory: 256MB Timeout: 10s Triggers: Cognito Post-Authentication Má»¥c Ä‘Ã­ch: Táº¡o profile ngÆ°á»i dÃ¹ng khi Ä‘Äƒng nháº­p láº§n Ä‘áº§u Lambda 2: Recipe CRUD#\rRuntime: Node.js 20 Memory: 512MB Timeout: 30s Triggers: API Gateway Má»¥c Ä‘Ã­ch: Táº¡o, Ä‘á»c, cáº­p nháº­t, xÃ³a recipes Upload áº£nh recipe lÃªn S3 Query DynamoDB Lambda 3: AI Suggestion Engine â­#\rRuntime: Node.js 20 Memory: 1024MB Timeout: 60s Triggers: API Gateway Má»¥c Ä‘Ã­ch: Validate nguyÃªn liá»‡u vá»›i master_ingredients table Query 4 approved recipes tá»« DynamoDB Gá»i Amazon Bedrock (Claude 3.5) cho 1 recipe má»›i Táº¡o gá»£i Ã½ cÃ´ng thá»©c PhÃ¢n tÃ­ch nguyÃªn liá»‡u ngÆ°á»i dÃ¹ng LÆ°u gá»£i Ã½ vÃ o DynamoDB Chi phÃ­: Lambda tá»‘n kÃ©m nháº¥t (~70% chi phÃ­ compute) Lambda 4: User Profile Manager#\rRuntime: Node.js 20 Memory: 256MB Timeout: 10s Triggers: API Gateway Má»¥c Ä‘Ã­ch: Quáº£n lÃ½ profile \u0026amp; preferences ngÆ°á»i dÃ¹ng Cáº­p nháº­t danh sÃ¡ch nguyÃªn liá»‡u Xá»­ lÃ½ upload avatar Quáº£n lÃ½ cÃ i Ä‘áº·t riÃªng tÆ° Lambda 5: Social/Friends Handler#\rRuntime: Node.js 20 Memory: 256MB Timeout: 10s Triggers: API Gateway Má»¥c Ä‘Ã­ch: Quáº£n lÃ½ yÃªu cáº§u káº¿t báº¡n Cháº¥p nháº­n/tá»« chá»‘i yÃªu cáº§u káº¿t báº¡n Liá»‡t kÃª danh sÃ¡ch báº¡n bÃ¨ Lá»c dá»¯ liá»‡u theo privacy settings Lambda 6: Posts \u0026amp; Comments Handler#\rRuntime: Node.js 20 Memory: 512MB Timeout: 30s Triggers: API Gateway Má»¥c Ä‘Ã­ch: Táº¡o, Ä‘á»c, cáº­p nháº­t, xÃ³a bÃ i Ä‘Äƒng Quáº£n lÃ½ bÃ¬nh luáº­n (nested replies) Upload áº£nh posts lÃªn S3 Cáº­p nháº­t counters (likes_count, comments_count) Lá»c theo privacy settings Lambda 7: Notifications Handler#\rRuntime: Node.js 20 Memory: 256MB Timeout: 10s Triggers: API Gateway, DynamoDB Streams Má»¥c Ä‘Ã­ch: Táº¡o thÃ´ng bÃ¡o khi cÃ³ hoáº¡t Ä‘á»™ng (comment, like, friend request) ÄÃ¡nh dáº¥u Ä‘Ã£ Ä‘á»c/chÆ°a Ä‘á»c Láº¥y danh sÃ¡ch thÃ´ng bÃ¡o Push notifications (tÆ°Æ¡ng lai) Lambda 8: Admin Operations#\rRuntime: Node.js 20 Memory: 512MB Timeout: 30s Triggers: API Gateway (Chá»‰ Admin) Má»¥c Ä‘Ã­ch: Quáº£n lÃ½ ngÆ°á»i dÃ¹ng (ban/unban) Kiá»ƒm duyá»‡t ná»™i dung (posts, comments) Thá»‘ng kÃª há»‡ thá»‘ng KhÃ´ng cáº§n phÃª duyá»‡t recipes - Tá»± Ä‘á»™ng approval dá»±a trÃªn rating Lambda 9: Cooking History Handler â­ NEW#\rRuntime: Node.js 20 Memory: 256MB Timeout: 10s Triggers: API Gateway Má»¥c Ä‘Ã­ch: Quáº£n lÃ½ lá»‹ch sá»­ náº¥u Äƒn cÃ¡ nhÃ¢n Start/complete cooking sessions Láº¥y lá»‹ch sá»­ náº¥u Äƒn cá»§a user ÄÃ¡nh dáº¥u mÃ³n yÃªu thÃ­ch Ghi chÃº cÃ¡ nhÃ¢n cho tá»«ng láº§n náº¥u Lambda 10: Rating \u0026amp; Approval Handler â­ NEW#\rRuntime: Node.js 20 Memory: 256MB Timeout: 10s Triggers: API Gateway Má»¥c Ä‘Ã­ch: LÆ°u rating cá»§a user cho recipes TÃ­nh toÃ¡n average rating Auto-approve recipes khi rating \u0026gt;= 4.0 sao Update recipe_ratings table Link rating vá»›i cooking history Lambda 11: Ingredient Validation Handler â­ NEW#\rRuntime: Node.js 20 Memory: 256MB Timeout: 10s Triggers: API Gateway Má»¥c Ä‘Ã­ch: Validate nguyÃªn liá»‡u vá»›i master_ingredients table Fuzzy search cho nguyÃªn liá»‡u tÆ°Æ¡ng tá»± Auto-correct tÃªn nguyÃªn liá»‡u (bá» dáº¥u) Gá»£i Ã½ nguyÃªn liá»‡u thay tháº¿ 5. Dá»‹ch Vá»¥ AI/ML#\rAmazon Bedrock (Claude 3.5)#\rModel: Claude 3.5 Sonnet (hoáº·c Haiku Ä‘á»ƒ tiáº¿t kiá»‡m chi phÃ­) Use Case: AI agent gá»£i Ã½ cÃ´ng thá»©c Input: Profile ngÆ°á»i dÃ¹ng + preferences + nguyÃªn liá»‡u Output: Gá»£i Ã½ cÃ´ng thá»©c vá»›i hÆ°á»›ng dáº«n Chi phÃ­: Sonnet: $3 trÃªn triá»‡u input tokens, $15 trÃªn triá»‡u output tokens Haiku: $0.25 trÃªn triá»‡u input tokens, $1.25 trÃªn triá»‡u output tokens Æ¯á»›c tÃ­nh: $25-50/thÃ¡ng (1,000 users, 10 suggestions/user/thÃ¡ng) Vá»›i Haiku: $3-7/thÃ¡ng (tiáº¿t kiá»‡m 70%) 6. Database#\rAmazon DynamoDB (NoSQL Database)#\rCÃ¡c báº£ng:\nUsers (PK: user_id) - TÃ i khoáº£n ngÆ°á»i dÃ¹ng \u0026amp; roles UserData (PK: user_id, SK: data_type) - Preferences, nguyÃªn liá»‡u PrivacySettings (PK: user_id) - Cáº¥u hÃ¬nh riÃªng tÆ° Friendships (PK: user_id, SK: friend_id) - Káº¿t ná»‘i máº¡ng xÃ£ há»™i Recipes (PK: recipe_id, GSI: user_id) - Dá»¯ liá»‡u cÃ´ng thá»©c RecipeRatings (PK: recipe_id, SK: user_id) - ÄÃ¡nh giÃ¡ cÃ´ng thá»©c cho auto-approval â­ UserCookingHistory (PK: user_id, SK: timestamp) - Lá»‹ch sá»­ náº¥u Äƒn cÃ¡ nhÃ¢n â­ MasterIngredients (PK: ingredient_id) - Master list nguyÃªn liá»‡u Ä‘á»ƒ validate â­ AISuggestions (PK: user_id, SK: timestamp) - Lá»‹ch sá»­ AI Posts (PK: post_id, GSI: user_id) - BÃ i Ä‘Äƒng xÃ£ há»™i Comments (PK: post_id, SK: timestamp) - BÃ¬nh luáº­n Reactions (PK: target_id, SK: user_id) - LÆ°á»£t thÃ­ch Notifications (PK: user_id, SK: timestamp) - ThÃ´ng bÃ¡o TÃ­nh nÄƒng:\nAuto-scaling (on-demand mode) Point-in-time recovery (PITR) DynamoDB Streams (cho cáº­p nháº­t real-time \u0026amp; notifications) Global Secondary Indexes (GSI) cho truy váº¥n MÃ£ hÃ³a at rest Chi phÃ­: $35-45/thÃ¡ng (on-demand pricing vá»›i cooking history \u0026amp; ratings) Táº¡i sao chá»n DynamoDB thay vÃ¬ RDS?\nâœ… Serverless (khÃ´ng cáº§n quáº£n lÃ½ server) âœ… Auto-scaling vá» zero cost khi idle âœ… TÃ­ch há»£p tá»‘t hÆ¡n vá»›i Lambda âœ… Äá»™ trá»… tháº¥p hÆ¡n cho key-value access âœ… Tiáº¿t kiá»‡m chi phÃ­ cho MVP ($15 vs $30+ cho RDS) 7. LÆ°u Trá»¯#\rAmazon S3#\rBuckets:\nrecipe-images-prod: áº¢nh cÃ´ng thá»©c user-avatars-prod: áº¢nh Ä‘áº¡i diá»‡n post-images-prod: áº¢nh bÃ i Ä‘Äƒng static-assets-prod: Assets á»©ng dá»¥ng TÃ­nh nÄƒng:\nVersioning enabled Lifecycle policies (xÃ³a sau 90 ngÃ y cho temp files) S3 Transfer Acceleration Chi phÃ­: ~$10/thÃ¡ng (100GB storage vá»›i social media images) 8. Báº£o Máº­t#\rAWS WAF#\rBáº£o vá»‡:\nSQL injection XSS attacks Rate limiting (1000 requests/5min má»—i IP) Geographic restrictions (tÃ¹y chá»n) Chi phÃ­: $5/thÃ¡ng + $1 trÃªn triá»‡u requests AWS Secrets Manager#\rSecrets:\nDatabase credentials (náº¿u dÃ¹ng RDS) Third-party API keys (náº¿u cáº§n) Chi phÃ­: $0.40 má»—i secret má»—i thÃ¡ng 9. GiÃ¡m SÃ¡t \u0026amp; Logging#\rAmazon CloudWatch#\rLogs: Táº¥t cáº£ logs cá»§a Lambda functions Metrics: Metrics cá»§a API Gateway, Lambda, DynamoDB Alarms: Lambda errors \u0026gt; 1% API Gateway 5xx errors DynamoDB throttling Chi phÃ­: ~$5-10/thÃ¡ng AWS X-Ray#\rTracing: Tracing request tá»« Ä‘áº§u Ä‘áº¿n cuá»‘i Performance: XÃ¡c Ä‘á»‹nh bottlenecks Chi phÃ­: $5 trÃªn triá»‡u traces (100k Ä‘áº§u miá»…n phÃ­) SÆ¡ Äá»“ Luá»“ng Dá»¯ Liá»‡u#\rFlow 1: AI Recipe Suggestion (Enhanced - Flexible Mix)#\rsequenceDiagram\rparticipant User\rparticipant APIGateway\rparticipant LambdaAI\rparticipant DynamoDB\rparticipant Bedrock\rparticipant CloudWatch\rUser-\u0026gt;\u0026gt;APIGateway: POST /ai/suggest\u0026lt;br/\u0026gt;{ingredients, recipe_count: 3}\rAPIGateway-\u0026gt;\u0026gt;LambdaAI: Xá»­ lÃ½ request\rNote over LambdaAI: STEP 1: Validate Ingredients\rLambdaAI-\u0026gt;\u0026gt;DynamoDB: Check master_ingredients\rDynamoDB--\u0026gt;\u0026gt;LambdaAI: Validation results\ralt CÃ³ nguyÃªn liá»‡u khÃ´ng há»£p lá»‡\rLambdaAI-\u0026gt;\u0026gt;CloudWatch: Log invalid ingredients\rLambdaAI-\u0026gt;\u0026gt;DynamoDB: Increment report count\ralt Report count \u0026gt;= 5\rLambdaAI-\u0026gt;\u0026gt;DynamoDB: Notify admin\rend\rend\rNote over LambdaAI: STEP 2: Query DB vá»›i categories\rLambdaAI-\u0026gt;\u0026gt;DynamoDB: Query approved recipes\u0026lt;br/\u0026gt;(match ingredients + categories)\rDynamoDB--\u0026gt;\u0026gt;LambdaAI: Found: 2 mÃ³n\rNote over LambdaAI: STEP 3: Calculate AI Gap\u0026lt;br/\u0026gt;Requested: 3, DB: 2, Gap: 1\rNote over LambdaAI: STEP 4: Generate AI (náº¿u cáº§n)\rloop For each AI recipe (1 mÃ³n)\rLambdaAI-\u0026gt;\u0026gt;Bedrock: Generate recipe\u0026lt;br/\u0026gt;(ingredients + diverse category)\rBedrock--\u0026gt;\u0026gt;LambdaAI: AI Recipe\rend\rNote over LambdaAI: STEP 5: Combine \u0026amp; Return\rLambdaAI-\u0026gt;\u0026gt;DynamoDB: Save suggestion history\rLambdaAI--\u0026gt;\u0026gt;User: 2 DB + 1 AI = 3 mÃ³n âœ…\u0026lt;br/\u0026gt;+ Warnings (if any)Key Improvements:\nâœ… Flexible recipe count (1-5 mÃ³n) âœ… Dynamic DB/AI mix (tiáº¿t kiá»‡m cost) âœ… Invalid ingredient reporting system âœ… Category diversity (xÃ o, canh, háº¥p\u0026hellip;) Flow 2: Recipe Auto-Approval (Rating-based)#\rsequenceDiagram\rparticipant User\rparticipant APIGateway\rparticipant LambdaRecipe\rparticipant DynamoDB\rUser-\u0026gt;\u0026gt;APIGateway: Náº¥u mÃ³n (AI generated)\rUser-\u0026gt;\u0026gt;APIGateway: Click \u0026#34;HoÃ n thÃ nh\u0026#34;\rAPIGateway-\u0026gt;\u0026gt;User: Hiá»ƒn thá»‹ form Ä‘Ã¡nh giÃ¡\rUser-\u0026gt;\u0026gt;APIGateway: POST /recipes/{id}/rate (rating + comment)\rAPIGateway-\u0026gt;\u0026gt;LambdaRecipe: LÆ°u rating\rLambdaRecipe-\u0026gt;\u0026gt;DynamoDB: Save rating\rLambdaRecipe-\u0026gt;\u0026gt;DynamoDB: Calculate average rating\ralt Rating \u0026gt;= 4 sao\rLambdaRecipe-\u0026gt;\u0026gt;DynamoDB: Set recipe.is_approved = true\rLambdaRecipe-\u0026gt;\u0026gt;DynamoDB: Add to public recipes\rLambdaRecipe-\u0026gt;\u0026gt;User: \u0026#34;CÃ´ng thá»©c Ä‘Ã£ Ä‘Æ°á»£c thÃªm vÃ o database!\u0026#34;\relse Rating \u0026lt; 4 sao\rLambdaRecipe-\u0026gt;\u0026gt;User: \u0026#34;Cáº£m Æ¡n Ä‘Ã¡nh giÃ¡ cá»§a báº¡n!\u0026#34;\rendFlow 3: Social Interaction#\rsequenceDiagram\rparticipant User\rparticipant APIGateway\rparticipant LambdaPost\rparticipant LambdaNotification\rparticipant DynamoDB\rUser-\u0026gt;\u0026gt;APIGateway: POST /posts (chia sáº» cÃ´ng thá»©c)\rAPIGateway-\u0026gt;\u0026gt;LambdaPost: Táº¡o post\rLambdaPost-\u0026gt;\u0026gt;DynamoDB: Save post\rLambdaPost-\u0026gt;\u0026gt;User: Post created\rUser-\u0026gt;\u0026gt;APIGateway: POST /posts/{id}/comments\rAPIGateway-\u0026gt;\u0026gt;LambdaPost: Táº¡o comment\rLambdaPost-\u0026gt;\u0026gt;DynamoDB: Save comment\rLambdaPost-\u0026gt;\u0026gt;DynamoDB: Update comments_count\rLambdaPost-\u0026gt;\u0026gt;LambdaNotification: Trigger notification\rLambdaNotification-\u0026gt;\u0026gt;DynamoDB: Create notification for post owner\rLambdaNotification-\u0026gt;\u0026gt;User: Push notificationFlow 4: Error Handling - Invalid Ingredients#\rsequenceDiagram\rparticipant User\rparticipant APIGateway\rparticipant LambdaAI\rparticipant DynamoDB\rUser-\u0026gt;\u0026gt;APIGateway: POST /ai/suggest {\u0026#34;ingredients\u0026#34;: [\u0026#34;abc xyz\u0026#34;, \u0026#34;123\u0026#34;]}\rAPIGateway-\u0026gt;\u0026gt;LambdaAI: Validate ingredients\ralt NguyÃªn liá»‡u khÃ´ng tá»“n táº¡i\rLambdaAI-\u0026gt;\u0026gt;DynamoDB: Fuzzy search similar ingredients\rLambdaAI-\u0026gt;\u0026gt;User: Error 400: \u0026#34;KhÃ´ng tÃ¬m tháº¥y nguyÃªn liá»‡u. Báº¡n cÃ³ muá»‘n: [gÃ , cÃ¡, tÃ´m]?\u0026#34;\relse NguyÃªn liá»‡u sai format\rLambdaAI-\u0026gt;\u0026gt;User: Error 400: \u0026#34;TÃªn nguyÃªn liá»‡u khÃ´ng há»£p lá»‡. Vui lÃ²ng nháº­p láº¡i.\u0026#34;\relse NguyÃªn liá»‡u quÃ¡ Ã­t (\u0026lt; 2)\rLambdaAI-\u0026gt;\u0026gt;User: Error 400: \u0026#34;Cáº§n Ã­t nháº¥t 2 nguyÃªn liá»‡u Ä‘á»ƒ táº¡o mÃ³n Äƒn.\u0026#34;\rend"},{"id":1,"href":"/docs/summary/","title":"Summary","section":"Docs","content":"AWS Project Documentation#\rComplete documentation for Smart Cooking App project.\n"},{"id":2,"href":"/docs/summary/ai-agent-implementation/","title":"Káº¿ Hoáº¡ch Triá»ƒn Khai AI Agent","section":"Summary","content":"Káº¾ HOáº CH TRIá»‚N KHAI AI AGENT#\rHá»‡ Thá»‘ng Gá»£i Ã CÃ´ng Thá»©c ThÃ´ng Minh\nğŸ“‹ Tá»”NG QUAN#\rTÃ­nh nÄƒng: AI Agent gá»£i Ã½ mÃ³n Äƒn thÃ´ng minh dá»±a trÃªn:\nThÃ´ng tin cÃ¡ nhÃ¢n (giá»›i tÃ­nh, tuá»•i, quá»‘c gia) Sá»Ÿ thÃ­ch áº©m thá»±c (mÃ³n canh, mÃ³n chiÃªn, mÃ³n háº¥pâ€¦) NguyÃªn liá»‡u nháº­p Ä‘Æ¡n giáº£n (chá»‰ tÃªn, khÃ´ng quáº£n lÃ½ sá»‘ lÆ°á»£ng/háº¡n dÃ¹ng) Pháº¡m vi:\nâœ… User nháº­p danh sÃ¡ch nguyÃªn liá»‡u âœ… System check nguyÃªn liá»‡u há»£p lá»‡ âœ… Gá»£i Ã½ 4 mÃ³n tá»« database + 1 mÃ³n AI táº¡o má»›i âœ… Auto-approval cÃ´ng thá»©c dá»±a trÃªn rating (\u0026gt;= 4 sao) âœ… Error handling cho nguyÃªn liá»‡u khÃ´ng há»£p lá»‡ Thá»i gian: 2 tuáº§n (Tuáº§n 3-4 trong deployment plan)\nğŸ¯ LUá»’NG NGÆ¯á»œI DÃ™NG#\rFlow 1: Gá»£i Ã MÃ³n Ä‚n ThÃ´ng Minh (Smart Suggestion)#\râ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\râ”‚ Äáº¦U VÃ€O NGÆ¯á»œI DÃ™NG â”‚\râ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\râ”‚ NgÆ°á»i dÃ¹ng A: â”‚\râ”‚ â€¢ Nam, 1990 (34 tuá»•i), Vietnam â”‚\râ”‚ â€¢ ThÃ­ch Äƒn: canh, mÃ³n háº¥p â”‚\râ”‚ â€¢ NguyÃªn liá»‡u nháº­p: CÃ¡ rÃ´, bÃ´ng sÃºng, gá»«ng, hÃ nh â”‚\râ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\râ”‚\râ–¼\râ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\râ”‚ VALIDATE \u0026amp; PROCESS â”‚\râ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\râ”‚ 1. Check nguyÃªn liá»‡u há»£p lá»‡: â”‚\râ”‚ âœ… \u0026#34;CÃ¡ rÃ´\u0026#34; â†’ CÃ³ trong database â”‚\râ”‚ âœ… \u0026#34;BÃ´ng sÃºng\u0026#34; â†’ CÃ³ trong database â”‚\râ”‚ âœ… \u0026#34;Gá»«ng\u0026#34; â†’ CÃ³ trong database â”‚\râ”‚ âœ… \u0026#34;HÃ nh\u0026#34; â†’ CÃ³ trong database â”‚\râ”‚ â”‚\râ”‚ 2. TÃ¬m cÃ´ng thá»©c: â”‚\râ”‚ - Query DynamoDB: 4 mÃ³n match nguyÃªn liá»‡u â”‚\râ”‚ - Gá»i AI Bedrock: 1 mÃ³n má»›i sÃ¡ng táº¡o â”‚\râ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\râ”‚\râ–¼\râ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\râ”‚ Káº¾T QUáº¢ Gá»¢I Ã (5 MÃ“N) â”‚\râ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\râ”‚ ğŸ“¦ Tá»« Database (4 mÃ³n): â”‚\râ”‚ 1. Canh cÃ¡ rÃ´ náº¥u bÃ´ng sÃºng â”‚\râ”‚ 2. CÃ¡ rÃ´ kho gá»«ng â”‚\râ”‚ 3. Canh bÃ´ng sÃºng â”‚\râ”‚ 4. CÃ¡ rÃ´ chiÃªn â”‚\râ”‚ â”‚\râ”‚ ğŸ¤– AI Generated (1 mÃ³n má»›i): â”‚\râ”‚ 5. CÃ¡ rÃ´ háº¥p bÃ´ng sÃºng gá»«ng hÃ nh â”‚\râ”‚ (MÃ³n Ä‘á»™c Ä‘Ã¡o tá»« AI) â”‚\râ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜Flow 2: Auto-Approval CÃ´ng Thá»©c (Rating-based)#\râ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\râ”‚ USER Náº¤U MÃ“N AI Táº O â”‚\râ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\râ”‚ 1. User chá»n mÃ³n: \u0026#34;CÃ¡ rÃ´ háº¥p bÃ´ng sÃºng gá»«ng hÃ nh\u0026#34; â”‚\râ”‚ 2. LÃ m theo hÆ°á»›ng dáº«n â”‚\râ”‚ 3. Click \u0026#34;HoÃ n thÃ nh\u0026#34; â”‚\râ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\râ”‚\râ–¼\râ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\râ”‚ ÄÃNH GIÃ CÃ”NG THá»¨C â”‚\râ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\râ”‚ Popup hiá»ƒn thá»‹: â”‚\râ”‚ â€¢ Rating: â­â­â­â­â­ (1-5 sao) â”‚\râ”‚ â€¢ Comment: \u0026#34;MÃ³n nÃ y ráº¥t ngon!\u0026#34; â”‚\râ”‚ â€¢ Submit â”‚\râ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\râ”‚\râ–¼\râ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\râ”‚ Xá»¬ LÃ RATING â”‚\râ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\râ”‚ IF rating \u0026gt;= 4 sao: â”‚\râ”‚ âœ… Set recipe.is_approved = true â”‚\râ”‚ âœ… Add to public recipes database â”‚\râ”‚ âœ… Notify: \u0026#34;CÃ´ng thá»©c Ä‘Ã£ Ä‘Æ°á»£c thÃªm vÃ o database!\u0026#34; â”‚\râ”‚ â”‚\râ”‚ ELSE (rating \u0026lt; 4 sao): â”‚\râ”‚ â„¹ï¸ Notify: \u0026#34;Cáº£m Æ¡n Ä‘Ã¡nh giÃ¡ cá»§a báº¡n!\u0026#34; â”‚\râ”‚ âŒ KhÃ´ng thÃªm vÃ o database â”‚\râ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜Flow 3: Error Handling - NguyÃªn Liá»‡u KhÃ´ng Há»£p Lá»‡#\râ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\râ”‚ USER NHáº¬P NGUYÃŠN LIá»†U SAI â”‚\râ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\râ”‚ Input: \u0026#34;abc xyz\u0026#34;, \u0026#34;123\u0026#34;, \u0026#34;thit ga\u0026#34; â”‚\râ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\râ”‚\râ–¼\râ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\râ”‚ VALIDATE Tá»ªNG NGUYÃŠN LIá»†U â”‚\râ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\râ”‚ 1. \u0026#34;abc xyz\u0026#34; â†’ âŒ KhÃ´ng tá»“n táº¡i â”‚\râ”‚ â†’ Fuzzy search: TÃ¬m nguyÃªn liá»‡u gáº§n Ä‘Ãºng â”‚\râ”‚ â†’ Gá»£i Ã½: \u0026#34;Báº¡n cÃ³ muá»‘n: [gÃ , cÃ¡, bÃ²]?\u0026#34; â”‚\râ”‚ â”‚\râ”‚ 2. \u0026#34;123\u0026#34; â†’ âŒ Format khÃ´ng há»£p lá»‡ â”‚\râ”‚ â†’ Error: \u0026#34;TÃªn nguyÃªn liá»‡u khÃ´ng há»£p lá»‡\u0026#34; â”‚\râ”‚ â”‚\râ”‚ 3. \u0026#34;thit ga\u0026#34; â†’ âœ… Fuzzy match: \u0026#34;thá»‹t gÃ \u0026#34; â”‚\râ”‚ â†’ Auto-correct: \u0026#34;Báº¡n muá»‘n dÃ¹ng \u0026#39;thá»‹t gÃ \u0026#39;?\u0026#34; â”‚\râ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\râ”‚\râ–¼\râ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\râ”‚ ERROR RESPONSES â”‚\râ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\râ”‚ Case 1: NguyÃªn liá»‡u khÃ´ng tá»“n táº¡i â”‚\râ”‚ â†’ HTTP 400: { â”‚\râ”‚ \u0026#34;error\u0026#34;: \u0026#34;ingredient_not_found\u0026#34;, â”‚\râ”‚ \u0026#34;message\u0026#34;: \u0026#34;KhÃ´ng tÃ¬m tháº¥y nguyÃªn liá»‡u: abc xyz\u0026#34;, â”‚\râ”‚ \u0026#34;suggestions\u0026#34;: [\u0026#34;gÃ \u0026#34;, \u0026#34;cÃ¡\u0026#34;, \u0026#34;bÃ²\u0026#34;] â”‚\râ”‚ } â”‚\râ”‚ â”‚\râ”‚ Case 2: Format khÃ´ng há»£p lá»‡ â”‚\râ”‚ â†’ HTTP 400: { â”‚\râ”‚ \u0026#34;error\u0026#34;: \u0026#34;invalid_format\u0026#34;, â”‚\râ”‚ \u0026#34;message\u0026#34;: \u0026#34;TÃªn nguyÃªn liá»‡u khÃ´ng há»£p lá»‡: 123\u0026#34; â”‚\râ”‚ } â”‚\râ”‚ â”‚\râ”‚ Case 3: QuÃ¡ Ã­t nguyÃªn liá»‡u â”‚\râ”‚ â†’ HTTP 400: { â”‚\râ”‚ \u0026#34;error\u0026#34;: \u0026#34;insufficient_ingredients\u0026#34;, â”‚\râ”‚ \u0026#34;message\u0026#34;: \u0026#34;Cáº§n Ã­t nháº¥t 2 nguyÃªn liá»‡u\u0026#34; â”‚\râ”‚ } â”‚\râ”‚ â”‚\râ”‚ Case 4: Fuzzy match thÃ nh cÃ´ng â”‚\râ”‚ â†’ HTTP 200: { â”‚\râ”‚ \u0026#34;corrected\u0026#34;: true, â”‚\râ”‚ \u0026#34;original\u0026#34;: \u0026#34;thit ga\u0026#34;, â”‚\râ”‚ \u0026#34;matched\u0026#34;: \u0026#34;thá»‹t gÃ \u0026#34;, â”‚\râ”‚ \u0026#34;confidence\u0026#34;: 0.85 â”‚\râ”‚ } â”‚\râ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ğŸ—ï¸ TRIá»‚N KHAI Ká»¸ THUáº¬T#\rKiáº¿n TrÃºc Tables \u0026amp; Relationships#\rCÃ¡c Tables LiÃªn Káº¿t:\nmaster_ingredients (nguyÃªn liá»‡u chuáº©n)\râ†“\r[VALIDATE]\râ†“\ruser_ingredients (nguyÃªn liá»‡u ngÆ°á»i dÃ¹ng nháº­p)\râ†“\r[QUERY \u0026amp; MATCH]\râ†“\râ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\râ†“ â†“ â†“\rrecipes user_data user_preferences\r(is_approved) (sá»Ÿ thÃ­ch) (nÄƒm sinh, giá»›i tÃ­nh, quá»‘c gia)\râ†“ â†“ â†“\râ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\râ†“\r[AI AGENT PROMPT]\râ†“\râ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\râ†“ â†“\rDatabase Recipes AI Generated Recipe\r(4 mÃ³n phÃ¹ há»£p) (1 mÃ³n sÃ¡ng táº¡o)Backend: Node.js 20 Lambda Functions#\rLambda AI Suggestion Engine:\n// Sá»­ dá»¥ng AWS SDK v3 cho Bedrock const { BedrockRuntimeClient, InvokeModelCommand } = require(\u0026#39;@aws-sdk/client-bedrock-runtime\u0026#39;); const { DynamoDBClient } = require(\u0026#39;@aws-sdk/client-dynamodb\u0026#39;); const { DynamoDBDocumentClient, QueryCommand, PutCommand } = require(\u0026#39;@aws-sdk/lib-dynamodb\u0026#39;); const ddb = DynamoDBDocumentClient.from(new DynamoDBClient({})); // Flow má»›i: // 1. Validate ingredients vá»›i master_ingredients table // 2. Query 4 recipes tá»« DynamoDB (is_approved=true) // 3. Generate 1 recipe má»›i báº±ng Bedrock AI vá»›i context Ä‘áº§y Ä‘á»§ // 4. Return 5 suggestions (4 DB + 1 AI) async function suggestRecipes(userIngredients, userPreferences) { // Step 1: Validate ingredients vá»›i master_ingredients const validatedIngredients = await validateIngredientsWithMaster(userIngredients); if (!validatedIngredients.isValid) { return { statusCode: 400, body: { error: \u0026#39;ingredient_not_found\u0026#39;, message: \u0026#39;Má»™t sá»‘ nguyÃªn liá»‡u khÃ´ng há»£p lá»‡\u0026#39;, invalid_ingredients: validatedIngredients.invalidItems, suggestions: validatedIngredients.suggestions } }; } // Step 2: Query user preferences tá»« user_data table const userContext = await getUserContext(userPreferences.userId); // Step 3: Query 4 approved recipes tá»« DynamoDB matching user preferences const dbRecipes = await queryApprovedRecipesByIngredientsAndPreferences( validatedIngredients.ingredients, userContext, 4 ); // Step 4: Generate 1 AI recipe vá»›i context Ä‘áº§y Ä‘á»§ const aiRecipe = await generateAIRecipe( validatedIngredients.ingredients, userContext ); // Step 5: Save AI suggestion to history await saveAISuggestion({ userId: userPreferences.userId, ingredients: validatedIngredients.ingredients, aiRecipe, dbRecipes }); // Step 6: Return combined results return { statusCode: 200, body: { recipes: [...dbRecipes, aiRecipe], stats: { database_recipes: dbRecipes.length, ai_recipes: 1 } } }; } // Láº¥y thÃ´ng tin ngÆ°á»i dÃ¹ng tá»« user_data \u0026amp; user_preferences async function getUserContext(userId) { // Query user_data cho sá»Ÿ thÃ­ch mÃ³n Äƒn const userDataResult = await ddb.send(new QueryCommand({ TableName: \u0026#39;smart-cooking-data\u0026#39;, KeyConditionExpression: \u0026#39;PK = :pk AND SK = :sk\u0026#39;, ExpressionAttributeValues: { \u0026#39;:pk\u0026#39;: `USER#${userId}`, \u0026#39;:sk\u0026#39;: \u0026#39;PREFERENCES\u0026#39; } })); // Query user profile cho thÃ´ng tin cÃ¡ nhÃ¢n (nÄƒm sinh, giá»›i tÃ­nh, quá»‘c gia) const userProfileResult = await ddb.send(new QueryCommand({ TableName: \u0026#39;smart-cooking-data\u0026#39;, KeyConditionExpression: \u0026#39;PK = :pk AND SK = :sk\u0026#39;, ExpressionAttributeValues: { \u0026#39;:pk\u0026#39;: `USER#${userId}`, \u0026#39;:sk\u0026#39;: \u0026#39;METADATA\u0026#39; } })); const userData = userDataResult.Items?.[0] || {}; const userProfile = userProfileResult.Items?.[0] || {}; return { // Sá»Ÿ thÃ­ch mÃ³n Äƒn preferred_cooking_methods: userData.preferred_cooking_methods || [], preferred_meal_types: userData.preferred_meal_types || [], favorite_cuisines: userData.favorite_cuisines || [], allergies: userData.allergies || [], // ThÃ´ng tin cÃ¡ nhÃ¢n (cho personalization) birth_year: userProfile.birth_year, gender: userProfile.gender, country: userProfile.country, // Má»Ÿ rá»™ng: mÃ³n yÃªu thÃ­ch quá»‘c gia // VD: náº¿u country = \u0026#34;Vietnam\u0026#34; â†’ Æ°u tiÃªn mÃ³n Viá»‡t // náº¿u favorite_cuisines = [\u0026#34;Italy\u0026#34;] â†’ Æ°u tiÃªn mÃ³n Ã cuisine_preference: determineCuisinePreference(userProfile, userData) }; } // XÃ¡c Ä‘á»‹nh Æ°u tiÃªn mÃ³n quá»‘c gia function determineCuisinePreference(profile, userData) { // Æ¯u tiÃªn 1: mÃ³n yÃªu thÃ­ch Ä‘Æ°á»£c chá»n if (userData.favorite_cuisines \u0026amp;\u0026amp; userData.favorite_cuisines.length \u0026gt; 0) { return userData.favorite_cuisines; } // Æ¯u tiÃªn 2: mÃ³n cá»§a quá»‘c gia ngÆ°á»i dÃ¹ng if (profile.country) { const countryToCuisine = { \u0026#39;Vietnam\u0026#39;: [\u0026#39;Vietnamese\u0026#39;], \u0026#39;Italy\u0026#39;: [\u0026#39;Italian\u0026#39;], \u0026#39;Japan\u0026#39;: [\u0026#39;Japanese\u0026#39;], \u0026#39;Thailand\u0026#39;: [\u0026#39;Thai\u0026#39;], \u0026#39;Korea\u0026#39;: [\u0026#39;Korean\u0026#39;] }; return countryToCuisine[profile.country] || []; } return []; } // Validate ingredients vá»›i master_ingredients table async function validateIngredientsWithMaster(ingredients) { const validated = []; const invalid = []; const suggestions = []; for (const ing of ingredients) { // Normalize input const normalized = normalizeText(ing); // Check exact match trong master_ingredients const exactMatch = await ddb.send(new QueryCommand({ TableName: \u0026#39;smart-cooking-data\u0026#39;, IndexName: \u0026#39;GSI1\u0026#39;, KeyConditionExpression: \u0026#39;GSI1PK = :pk AND begins_with(GSI1SK, :sk)\u0026#39;, ExpressionAttributeValues: { \u0026#39;:pk\u0026#39;: `INGREDIENT#SEARCH`, \u0026#39;:sk\u0026#39;: `NAME#${normalized}` } })); if (exactMatch.Items \u0026amp;\u0026amp; exactMatch.Items.length \u0026gt; 0) { validated.push(exactMatch.Items[0].name); } else { // Fuzzy search for similar ingredients const similar = await fuzzySearchIngredients(normalized); invalid.push(ing); suggestions.push({ original: ing, similar: similar.slice(0, 5) // Top 5 suggestions }); } } return { isValid: invalid.length === 0, ingredients: validated, invalidItems: invalid, suggestions }; } // Fuzzy search cho nguyÃªn liá»‡u tÆ°Æ¡ng tá»± async function fuzzySearchIngredients(searchTerm) { // Scan master_ingredients vá»›i filter const result = await ddb.send(new QueryCommand({ TableName: \u0026#39;smart-cooking-data\u0026#39;, IndexName: \u0026#39;GSI1\u0026#39;, KeyConditionExpression: \u0026#39;GSI1PK = :pk\u0026#39;, FilterExpression: \u0026#39;contains(normalized_name, :term) OR contains(aliases, :term)\u0026#39;, ExpressionAttributeValues: { \u0026#39;:pk\u0026#39;: `INGREDIENT#ACTIVE`, \u0026#39;:term\u0026#39;: searchTerm } })); return result.Items.map(item =\u0026gt; item.name); } // Query approved recipes matching ingredients AND user preferences async function queryApprovedRecipesByIngredientsAndPreferences(ingredients, userContext, limit) { // Query recipes theo nguyÃªn liá»‡u vÃ  sá»Ÿ thÃ­ch const recipes = await ddb.send(new QueryCommand({ TableName: \u0026#39;smart-cooking-data\u0026#39;, IndexName: \u0026#39;GSI2\u0026#39;, KeyConditionExpression: \u0026#39;GSI2PK = :pk\u0026#39;, FilterExpression: \u0026#39;is_approved = :approved\u0026#39;, ExpressionAttributeValues: { \u0026#39;:pk\u0026#39;: `RECIPES#APPROVED`, \u0026#39;:approved\u0026#39;: true }, ScanIndexForward: false // Sáº¯p xáº¿p theo rating cao nháº¥t })); let filteredRecipes = recipes.Items || []; // Filter theo mÃ³n yÃªu thÃ­ch quá»‘c gia (náº¿u cÃ³) if (userContext.cuisine_preference \u0026amp;\u0026amp; userContext.cuisine_preference.length \u0026gt; 0) { const cuisineMatches = filteredRecipes.filter(recipe =\u0026gt; userContext.cuisine_preference.includes(recipe.cuisine_type) ); // Náº¿u cÃ³ mÃ³n khá»›p quá»‘c gia, Æ°u tiÃªn chÃºng if (cuisineMatches.length \u0026gt; 0) { filteredRecipes = cuisineMatches; } } // Filter theo sá»Ÿ thÃ­ch cooking methods (canh, mÃ³n chiÃªn, mÃ³n háº¥p...) if (userContext.preferred_cooking_methods \u0026amp;\u0026amp; userContext.preferred_cooking_methods.length \u0026gt; 0) { filteredRecipes = filteredRecipes.filter(recipe =\u0026gt; userContext.preferred_cooking_methods.includes(recipe.cooking_method) ); } // Filter trÃ¡nh dá»‹ á»©ng if (userContext.allergies \u0026amp;\u0026amp; userContext.allergies.length \u0026gt; 0) { filteredRecipes = filteredRecipes.filter(recipe =\u0026gt; { const recipeIngredients = recipe.ingredients || []; return !recipeIngredients.some(ing =\u0026gt; userContext.allergies.includes(ing.ingredient_name) ); }); } return filteredRecipes.slice(0, limit); } // Normalize text (bá» dáº¥u, lowercase) function normalizeText(text) { return text .toLowerCase() .normalize(\u0026#39;NFD\u0026#39;) .replace(/[\\u0300-\\u036f]/g, \u0026#39;\u0026#39;) .trim(); }AI Agent Prompt \u0026amp; Privacy Policy:\n// Generate AI recipe vá»›i context Ä‘áº§y Ä‘á»§ + privacy protection async function generateAIRecipe(ingredients, userContext) { const bedrockClient = new BedrockRuntimeClient({ region: \u0026#39;us-east-1\u0026#39; }); // ===== PRIVACY POLICY ===== // Dá»¯ liá»‡u Ä‘Æ°á»£c sá»­ dá»¥ng cho personalization: // âœ… NÄƒm sinh (birth_year) - Ä‘á»ƒ tÃ­nh tuá»•i vÃ  khuyáº¿n nghá»‹ dinh dÆ°á»¡ng phÃ¹ há»£p // âœ… Giá»›i tÃ­nh (gender) - Ä‘á»ƒ khuyáº¿n nghá»‹ kháº©u pháº§n vÃ  dinh dÆ°á»¡ng // âœ… Quá»‘c gia (country) - Ä‘á»ƒ gá»£i Ã½ mÃ³n Äƒn Ä‘á»‹a phÆ°Æ¡ng/quá»‘c gia // âœ… Sá»Ÿ thÃ­ch mÃ³n (preferred_cooking_methods, favorite_cuisines) // âœ… Dá»‹ á»©ng (allergies) - QUAN TRá»ŒNG Ä‘á»ƒ an toÃ n thá»±c pháº©m // // âŒ KHÃ”NG sá»­ dá»¥ng: // - Email, sá»‘ Ä‘iá»‡n thoáº¡i, Ä‘á»‹a chá»‰ cá»¥ thá»ƒ // - TÃªn Ä‘áº§y Ä‘á»§ hoáº·c thÃ´ng tin Ä‘á»‹nh danh cÃ¡ nhÃ¢n khÃ¡c // // Má»¥c Ä‘Ã­ch: CÃ¡ nhÃ¢n hÃ³a gá»£i Ã½ mÃ³n Äƒn, KHÃ”NG theo dÃµi hoáº·c khai thÃ¡c thÃ´ng tin cÃ¡ nhÃ¢n // TÃ­nh tuá»•i tá»« nÄƒm sinh (náº¿u cÃ³) const age = userContext.birth_year ? new Date().getFullYear() - userContext.birth_year : null; // Táº¡o prompt cho AI vá»›i context Ä‘áº§y Ä‘á»§ const prompt = `Báº¡n lÃ  má»™t Ä‘áº§u báº¿p chuyÃªn nghiá»‡p. HÃ£y táº¡o má»™t cÃ´ng thá»©c náº¥u Äƒn sÃ¡ng táº¡o dá»±a trÃªn thÃ´ng tin sau: **NguyÃªn liá»‡u cÃ³ sáºµn:** ${ingredients.map(ing =\u0026gt; `- ${ing}`).join(\u0026#39;\\n\u0026#39;)} **ThÃ´ng tin ngÆ°á»i dÃ¹ng (Ä‘á»ƒ cÃ¡ nhÃ¢n hÃ³a):** ${age ? `- Tuá»•i: ${age} tuá»•i (khuyáº¿n nghá»‹ dinh dÆ°á»¡ng phÃ¹ há»£p)` : \u0026#39;\u0026#39;} ${userContext.gender ? `- Giá»›i tÃ­nh: ${userContext.gender} (kháº©u pháº§n phÃ¹ há»£p)` : \u0026#39;\u0026#39;} ${userContext.country ? `- Quá»‘c gia: ${userContext.country} (gá»£i Ã½ mÃ³n Ä‘á»‹a phÆ°Æ¡ng)` : \u0026#39;\u0026#39;} **Sá»Ÿ thÃ­ch mÃ³n Äƒn:** ${userContext.preferred_cooking_methods?.length \u0026gt; 0 ? `- ThÃ­ch: ${userContext.preferred_cooking_methods.join(\u0026#39;, \u0026#39;)}` : \u0026#39;- KhÃ´ng cÃ³ sá»Ÿ thÃ­ch cá»¥ thá»ƒ\u0026#39;} **MÃ³n yÃªu thÃ­ch quá»‘c gia:** ${userContext.cuisine_preference?.length \u0026gt; 0 ? `- Æ¯u tiÃªn mÃ³n: ${userContext.cuisine_preference.join(\u0026#39;, \u0026#39;)}` : \u0026#39;- KhÃ´ng cÃ³ mÃ³n quá»‘c gia yÃªu thÃ­ch\u0026#39;} **Dá»‹ á»©ng (TRÃNH TUYá»†T Äá»I):** ${userContext.allergies?.length \u0026gt; 0 ? userContext.allergies.map(a =\u0026gt; `- âŒ ${a}`).join(\u0026#39;\\n\u0026#39;) : \u0026#39;- KhÃ´ng cÃ³ dá»‹ á»©ng\u0026#39;} **YÃªu cáº§u:** 1. Sá»­ dá»¥ng TOÃ€N Bá»˜ hoáº·c pháº§n lá»›n nguyÃªn liá»‡u Ä‘Ã£ cho 2. Náº¿u ngÆ°á»i dÃ¹ng tá»« ${userContext.country}, Æ°u tiÃªn phong cÃ¡ch náº¥u Äƒn Ä‘á»‹a phÆ°Æ¡ng 3. Náº¿u thÃ­ch mÃ³n ${userContext.cuisine_preference?.join(\u0026#39;/\u0026#39;)}, táº¡o mÃ³n theo hÆ°á»›ng Ä‘Ã³ 4. Náº¿u thÃ­ch ${userContext.preferred_cooking_methods?.join(\u0026#39;/\u0026#39;)}, Æ°u tiÃªn phÆ°Æ¡ng phÃ¡p Ä‘Ã³ 5. TUYá»†T Äá»I KHÃ”NG dÃ¹ng nguyÃªn liá»‡u gÃ¢y dá»‹ á»©ng: ${userContext.allergies?.join(\u0026#39;, \u0026#39;) || \u0026#39;KhÃ´ng\u0026#39;} 6. PhÃ¹ há»£p vá»›i tuá»•i ${age ? `${age} tuá»•i` : \u0026#39;ngÆ°á»i lá»›n\u0026#39;} 7. MÃ³n Äƒn sÃ¡ng táº¡o, Ä‘á»™c Ä‘Ã¡o, chÆ°a cÃ³ trong database **Tráº£ vá» JSON format:** { \u0026#34;name\u0026#34;: \u0026#34;TÃªn mÃ³n Äƒn\u0026#34;, \u0026#34;cuisine_type\u0026#34;: \u0026#34;${userContext.cuisine_preference?.[0] || \u0026#39;Vietnamese\u0026#39;}\u0026#34;, \u0026#34;cooking_method\u0026#34;: \u0026#34;${userContext.preferred_cooking_methods?.[0] || \u0026#39;náº¥u\u0026#39;}\u0026#34;, \u0026#34;meal_type\u0026#34;: \u0026#34;mÃ³n chÃ­nh/mÃ³n phá»¥/canh\u0026#34;, \u0026#34;difficulty\u0026#34;: \u0026#34;dá»…/trung bÃ¬nh/khÃ³\u0026#34;, \u0026#34;cooking_time\u0026#34;: \u0026#34;30 phÃºt\u0026#34;, \u0026#34;servings\u0026#34;: 2, \u0026#34;ingredients\u0026#34;: [ { \u0026#34;ingredient_name\u0026#34;: \u0026#34;TÃªn nguyÃªn liá»‡u\u0026#34;, \u0026#34;quantity\u0026#34;: \u0026#34;100g\u0026#34;, \u0026#34;preparation\u0026#34;: \u0026#34;Cáº¯t nhá»\u0026#34; } ], \u0026#34;instructions\u0026#34;: [ { \u0026#34;step_number\u0026#34;: 1, \u0026#34;description\u0026#34;: \u0026#34;MÃ´ táº£ bÆ°á»›c lÃ m\u0026#34;, \u0026#34;duration\u0026#34;: \u0026#34;5 phÃºt\u0026#34; } ], \u0026#34;nutritional_info\u0026#34;: { \u0026#34;calories\u0026#34;: 300, \u0026#34;protein\u0026#34;: \u0026#34;20g\u0026#34;, \u0026#34;carbs\u0026#34;: \u0026#34;30g\u0026#34;, \u0026#34;fat\u0026#34;: \u0026#34;10g\u0026#34; }, \u0026#34;tags\u0026#34;: [\u0026#34;healthy\u0026#34;, \u0026#34;quick\u0026#34;], \u0026#34;notes\u0026#34;: \u0026#34;PhÃ¹ há»£p cho ngÆ°á»i ${age ? `${age} tuá»•i` : \u0026#39;ngÆ°á»i lá»›n\u0026#39;}\u0026#34; }`; try { const response = await bedrockClient.send(new InvokeModelCommand({ modelId: \u0026#39;anthropic.claude-3-haiku-20240307-v1:0\u0026#39;, contentType: \u0026#39;application/json\u0026#39;, accept: \u0026#39;application/json\u0026#39;, body: JSON.stringify({ anthropic_version: \u0026#39;bedrock-2023-05-31\u0026#39;, max_tokens: 2048, messages: [ { role: \u0026#39;user\u0026#39;, content: prompt } ] }) })); const responseBody = JSON.parse(new TextDecoder().decode(response.body)); const aiRecipeJSON = JSON.parse(responseBody.content[0].text); // ThÃªm metadata cho AI-generated recipe const aiRecipe = { ...aiRecipeJSON, recipe_id: `ai-gen-${generateUUID()}`, source: \u0026#39;ai\u0026#39;, is_new: true, is_approved: false, created_by: \u0026#39;bedrock-ai\u0026#39;, created_at: new Date().toISOString(), // Privacy metadata: Log ráº±ng Ä‘Ã£ sá»­ dá»¥ng thÃ´ng tin cÃ¡ nhÃ¢n (cho audit) personalization_used: { age_range: age ? `${Math.floor(age / 10) * 10}-${Math.floor(age / 10) * 10 + 9}` : null, gender: userContext.gender || null, country: userContext.country || null, cuisine_preference: userContext.cuisine_preference || [], allergies_avoided: userContext.allergies || [] } }; return aiRecipe; } catch (error) { console.error(\u0026#39;AI Recipe Generation Error:\u0026#39;, error); throw new Error(\u0026#39;Failed to generate AI recipe\u0026#39;); } }Lambda Recipe Rating Handler:\n// Auto-approval dá»±a trÃªn rating (\u0026gt;= 4 sao) async function handleRecipeRating(recipeId, userId, rating, comment, historyId) { // Validate rating (1-5) if (rating \u0026lt; 1 || rating \u0026gt; 5) { return { statusCode: 400, body: { error: \u0026#39;Invalid rating. Must be 1-5.\u0026#39; } }; } // Step 1: Save rating to recipe_ratings table await ddb.send(new PutCommand({ TableName: \u0026#39;smart-cooking-data\u0026#39;, Item: { PK: `RECIPE#${recipeId}`, SK: `RATING#${userId}`, rating_id: generateUUID(), recipe_id: recipeId, user_id: userId, rating, comment, history_id: historyId, is_verified_cook: historyId ? true : false, created_at: new Date().toISOString(), updated_at: new Date().toISOString() } })); // Step 2: Update user_cooking_history vá»›i personal_rating if (historyId) { await ddb.send(new PutCommand({ TableName: \u0026#39;smart-cooking-data\u0026#39;, Item: { PK: `USER#${userId}`, SK: `COOKING#${historyId}`, personal_rating: rating, updated_at: new Date().toISOString() } })); } // Step 3: Calculate average rating cho recipe const avgRating = await calculateAverageRating(recipeId); const ratingCount = await getRatingCount(recipeId); // Step 4: Auto-approve if \u0026gt;= 4.0 stars if (avgRating \u0026gt;= 4.0) { await ddb.send(new PutCommand({ TableName: \u0026#39;smart-cooking-data\u0026#39;, Item: { PK: `RECIPE#${recipeId}`, SK: \u0026#39;METADATA\u0026#39;, is_approved: true, is_public: true, approval_type: \u0026#39;auto_rating\u0026#39;, average_rating: avgRating, rating_count: ratingCount, approved_at: new Date().toISOString(), updated_at: new Date().toISOString() } })); return { statusCode: 200, body: { success: true, rating_saved: true, average_rating: avgRating, rating_count: ratingCount, auto_approved: true, message: \u0026#39;CÃ´ng thá»©c Ä‘Ã£ Ä‘Æ°á»£c thÃªm vÃ o database tá»•ng!\u0026#39; } }; } // Step 5: Rating \u0026lt; 4.0 - chá»‰ cáº£m Æ¡n return { statusCode: 200, body: { success: true, rating_saved: true, average_rating: avgRating, rating_count: ratingCount, auto_approved: false, message: \u0026#39;Cáº£m Æ¡n Ä‘Ã¡nh giÃ¡ cá»§a báº¡n!\u0026#39; } }; } // Calculate average rating async function calculateAverageRating(recipeId) { const result = await ddb.send(new QueryCommand({ TableName: \u0026#39;smart-cooking-data\u0026#39;, KeyConditionExpression: \u0026#39;PK = :pk AND begins_with(SK, :sk)\u0026#39;, ExpressionAttributeValues: { \u0026#39;:pk\u0026#39;: `RECIPE#${recipeId}`, \u0026#39;:sk\u0026#39;: \u0026#39;RATING#\u0026#39; } })); if (!result.Items || result.Items.length === 0) return 0; const total = result.Items.reduce((sum, item) =\u0026gt; sum + item.rating, 0); return (total / result.Items.length).toFixed(1); } // Get rating count async function getRatingCount(recipeId) { const result = await ddb.send(new QueryCommand({ TableName: \u0026#39;smart-cooking-data\u0026#39;, KeyConditionExpression: \u0026#39;PK = :pk AND begins_with(SK, :sk)\u0026#39;, ExpressionAttributeValues: { \u0026#39;:pk\u0026#39;: `RECIPE#${recipeId}`, \u0026#39;:sk\u0026#39;: \u0026#39;RATING#\u0026#39; }, Select: \u0026#39;COUNT\u0026#39; })); return result.Count || 0; }Lambda Cooking History Handler:\n// Quáº£n lÃ½ lá»‹ch sá»­ náº¥u Äƒn cÃ¡ nhÃ¢n async function startCooking(userId, recipeId, suggestionId) { const historyId = generateUUID(); await ddb.send(new PutCommand({ TableName: \u0026#39;smart-cooking-data\u0026#39;, Item: { PK: `USER#${userId}`, SK: `COOKING#${new Date().toISOString()}#${historyId}`, history_id: historyId, user_id: userId, recipe_id: recipeId, suggestion_id: suggestionId, status: \u0026#39;cooking\u0026#39;, created_at: new Date().toISOString(), updated_at: new Date().toISOString() } })); return { statusCode: 200, body: { history_id: historyId, message: \u0026#39;Báº¯t Ä‘áº§u náº¥u Äƒn!\u0026#39; } }; } // HoÃ n thÃ nh náº¥u Äƒn async function completeCooking(historyId, userId) { await ddb.send(new PutCommand({ TableName: \u0026#39;smart-cooking-data\u0026#39;, Item: { PK: `USER#${userId}`, SK: `COOKING#${historyId}`, status: \u0026#39;completed\u0026#39;, cook_date: new Date().toISOString(), updated_at: new Date().toISOString() } })); return { statusCode: 200, body: { message: \u0026#39;HoÃ n thÃ nh! Vui lÃ²ng Ä‘Ã¡nh giÃ¡ mÃ³n Äƒn.\u0026#39;, show_rating_form: true } }; } // Láº¥y lá»‹ch sá»­ náº¥u Äƒn async function getCookingHistory(userId) { const result = await ddb.send(new QueryCommand({ TableName: \u0026#39;smart-cooking-data\u0026#39;, KeyConditionExpression: \u0026#39;PK = :pk AND begins_with(SK, :sk)\u0026#39;, ExpressionAttributeValues: { \u0026#39;:pk\u0026#39;: `USER#${userId}`, \u0026#39;:sk\u0026#39;: \u0026#39;COOKING#\u0026#39; }, ScanIndexForward: false // Newest first })); return { statusCode: 200, body: { history: result.Items || [] } }; }Dá»‹ch Vá»¥ ChÃ­nh:\nAmazon Bedrock: Claude 3 Haiku model DynamoDB: LÆ°u trá»¯ dá»¯ liá»‡u ngÆ°á»i dÃ¹ng \u0026amp; gá»£i Ã½ AI Lambda: Serverless compute (Node.js 20) API Gateway: REST API endpoints CÆ¡ Sá»Ÿ Dá»¯ Liá»‡u: Amazon DynamoDB#\rCÃ¡c Báº£ng Sá»­ Dá»¥ng:\nUsers (PK: user_id) - Há»“ sÆ¡ \u0026amp; vai trÃ² UserData (PK: user_id, SK: PREFERENCES | INGREDIENTS) - CÃ i Ä‘áº·t ngÆ°á»i dÃ¹ng Recipes (PK: recipe_id) - CÃ´ng thá»©c (cÃ³ thÃªm field is_approved, approval_type, average_rating) RecipeRatings (PK: recipe_id, SK: user_id) - ÄÃ¡nh giÃ¡ cÃ´ng thá»©c cho auto-approval UserCookingHistory (PK: user_id, SK: timestamp) - Lá»‹ch sá»­ náº¥u Äƒn cÃ¡ nhÃ¢n (thay tháº¿ favorites) MasterIngredients (PK: ingredient_id) - Master list nguyÃªn liá»‡u Ä‘á»ƒ validate PrivacySettings (PK: user_id) - Cáº¥u hÃ¬nh quyá»n riÃªng tÆ° Friendships (PK: user_id, SK: friend_id) - Káº¿t ná»‘i xÃ£ há»™i AISuggestions (PK: user_id, SK: timestamp) - Lá»‹ch sá»­ AI Triá»ƒn Khai Quyá»n RiÃªng TÆ°:\n// Bá»™ lá»c quyá»n riÃªng tÆ° Ã¡p dá»¥ng trÆ°á»›c khi tráº£ vá» dá»¯ liá»‡u ngÆ°á»i dÃ¹ng if (privacy.ingredients_visibility === \u0026#39;friends\u0026#39; \u0026amp;\u0026amp; !isFriend) { delete userProfile.ingredients; }API Endpoints#\rLuá»“ng Gá»£i Ã AI (Enhanced - Flexible Mix):\nPOST /ai/suggest\rAuthorization: Bearer \u0026lt;JWT\u0026gt;\rBody: {\r\u0026#34;ingredients\u0026#34;: [\u0026#34;thá»‹t gÃ \u0026#34;, \u0026#34;cÃ  chua\u0026#34;, \u0026#34;hÃ nh\u0026#34;],\r\u0026#34;recipe_count\u0026#34;: 3 // NEW: 1-5 mÃ³n (default: 1)\r}\rResponse (Success - Flexible mix):\r{\r\u0026#34;suggestions\u0026#34;: [\r{\r\u0026#34;id\u0026#34;: \u0026#34;recipe-001\u0026#34;,\r\u0026#34;name\u0026#34;: \u0026#34;GÃ  xÃ o cÃ  chua\u0026#34;,\r\u0026#34;source\u0026#34;: \u0026#34;database\u0026#34;,\r\u0026#34;cooking_method\u0026#34;: \u0026#34;xÃ o\u0026#34;, // NEW\r\u0026#34;meal_type\u0026#34;: \u0026#34;mÃ³n chÃ­nh\u0026#34;, // NEW\r\u0026#34;match_score\u0026#34;: 0.95,\r\u0026#34;is_approved\u0026#34;: true,\r\u0026#34;average_rating\u0026#34;: 4.5\r},\r{\r\u0026#34;id\u0026#34;: \u0026#34;recipe-002\u0026#34;,\r\u0026#34;name\u0026#34;: \u0026#34;Canh cÃ  chua\u0026#34;,\r\u0026#34;source\u0026#34;: \u0026#34;database\u0026#34;,\r\u0026#34;cooking_method\u0026#34;: \u0026#34;canh\u0026#34;, // NEW - Diverse!\r\u0026#34;meal_type\u0026#34;: \u0026#34;canh\u0026#34;,\r\u0026#34;match_score\u0026#34;: 0.80,\r\u0026#34;is_approved\u0026#34;: true,\r\u0026#34;average_rating\u0026#34;: 4.2\r},\r{\r\u0026#34;id\u0026#34;: \u0026#34;ai-gen-001\u0026#34;,\r\u0026#34;name\u0026#34;: \u0026#34;GÃ  háº¥p cÃ  chua hÃ nh\u0026#34;,\r\u0026#34;source\u0026#34;: \u0026#34;ai\u0026#34;,\r\u0026#34;cooking_method\u0026#34;: \u0026#34;háº¥p\u0026#34;, // NEW - Diverse!\r\u0026#34;meal_type\u0026#34;: \u0026#34;mÃ³n chÃ­nh\u0026#34;,\r\u0026#34;is_new\u0026#34;: true,\r\u0026#34;is_approved\u0026#34;: false,\r\u0026#34;ingredients\u0026#34;: [...],\r\u0026#34;instructions\u0026#34;: [...]\r}\r],\r\u0026#34;stats\u0026#34;: {\r\u0026#34;requested\u0026#34;: 3, // NEW\r\u0026#34;from_database\u0026#34;: 2, // NEW - Flexible!\r\u0026#34;from_ai\u0026#34;: 1 // NEW - Only 1 AI call needed!\r},\r\u0026#34;warnings\u0026#34;: [] // NEW - Empty if all ingredients valid\r}\rResponse (Warning - Invalid ingredient but still work):\r{\r\u0026#34;suggestions\u0026#34;: [...], // Still return results\r\u0026#34;stats\u0026#34;: {\r\u0026#34;requested\u0026#34;: 3,\r\u0026#34;from_database\u0026#34;: 0, // Not enough valid ingredients for DB\r\u0026#34;from_ai\u0026#34;: 3 // AI handles it\r},\r\u0026#34;warnings\u0026#34;: [ // NEW\r{\r\u0026#34;ingredient\u0026#34;: \u0026#34;abc xyz\u0026#34;,\r\u0026#34;message\u0026#34;: \u0026#34;NguyÃªn liá»‡u khÃ´ng há»£p lá»‡, AI sáº½ cá»‘ gáº¯ng xá»­ lÃ½\u0026#34;,\r\u0026#34;suggestions\u0026#34;: [\u0026#34;gÃ \u0026#34;, \u0026#34;cÃ¡\u0026#34;, \u0026#34;bÃ²\u0026#34;],\r\u0026#34;reported\u0026#34;: true // ÄÃ£ log Ä‘á»ƒ admin review\r}\r]\r}\rResponse (Error - All invalid):\r{\r\u0026#34;error\u0026#34;: \u0026#34;all_ingredients_invalid\u0026#34;,\r\u0026#34;message\u0026#34;: \u0026#34;Táº¥t cáº£ nguyÃªn liá»‡u khÃ´ng há»£p lá»‡. Vui lÃ²ng nháº­p láº¡i.\u0026#34;,\r\u0026#34;invalid_ingredients\u0026#34;: [\u0026#34;abc\u0026#34;, \u0026#34;xyz\u0026#34;, \u0026#34;123\u0026#34;],\r\u0026#34;suggestions\u0026#34;: [\r{ \u0026#34;original\u0026#34;: \u0026#34;abc\u0026#34;, \u0026#34;similar\u0026#34;: [\u0026#34;cÃ¡\u0026#34;, \u0026#34;gÃ \u0026#34;] },\r{ \u0026#34;original\u0026#34;: \u0026#34;xyz\u0026#34;, \u0026#34;similar\u0026#34;: [\u0026#34;rau\u0026#34;, \u0026#34;cá»§\u0026#34;] }\r]\r}Luá»“ng Cooking History:\nPOST /cooking/start\rAuthorization: Bearer \u0026lt;JWT\u0026gt;\rBody: {\r\u0026#34;recipe_id\u0026#34;: \u0026#34;ai-gen-001\u0026#34;,\r\u0026#34;suggestion_id\u0026#34;: \u0026#34;suggestion-123\u0026#34;\r}\rResponse:\r{\r\u0026#34;history_id\u0026#34;: \u0026#34;history-001\u0026#34;,\r\u0026#34;message\u0026#34;: \u0026#34;Báº¯t Ä‘áº§u náº¥u Äƒn!\u0026#34;\r}\rPUT /cooking/{history_id}/complete\rAuthorization: Bearer \u0026lt;JWT\u0026gt;\rResponse:\r{\r\u0026#34;message\u0026#34;: \u0026#34;HoÃ n thÃ nh! Vui lÃ²ng Ä‘Ã¡nh giÃ¡ mÃ³n Äƒn.\u0026#34;,\r\u0026#34;show_rating_form\u0026#34;: true\r}\rGET /user/cooking-history\rAuthorization: Bearer \u0026lt;JWT\u0026gt;\rResponse:\r{\r\u0026#34;history\u0026#34;: [\r{\r\u0026#34;history_id\u0026#34;: \u0026#34;history-001\u0026#34;,\r\u0026#34;recipe_id\u0026#34;: \u0026#34;ai-gen-001\u0026#34;,\r\u0026#34;status\u0026#34;: \u0026#34;completed\u0026#34;,\r\u0026#34;personal_rating\u0026#34;: 5,\r\u0026#34;is_favorite\u0026#34;: true,\r\u0026#34;cook_date\u0026#34;: \u0026#34;2025-10-03T10:30:00Z\u0026#34;\r},\r...\r]\r}Luá»“ng Rating \u0026amp; Auto-Approval:\nPOST /recipes/{id}/rate\rAuthorization: Bearer \u0026lt;JWT\u0026gt;\rBody: {\r\u0026#34;rating\u0026#34;: 5,\r\u0026#34;comment\u0026#34;: \u0026#34;MÃ³n nÃ y ráº¥t ngon!\u0026#34;,\r\u0026#34;history_id\u0026#34;: \u0026#34;history-001\u0026#34;\r}\rResponse (Auto-approved):\r{\r\u0026#34;success\u0026#34;: true,\r\u0026#34;rating_saved\u0026#34;: true,\r\u0026#34;average_rating\u0026#34;: 4.2,\r\u0026#34;rating_count\u0026#34;: 15,\r\u0026#34;auto_approved\u0026#34;: true,\r\u0026#34;message\u0026#34;: \u0026#34;CÃ´ng thá»©c Ä‘Ã£ Ä‘Æ°á»£c thÃªm vÃ o database!\u0026#34;,\r\u0026#34;recipe\u0026#34;: {\r\u0026#34;id\u0026#34;: \u0026#34;ai-gen-001\u0026#34;,\r\u0026#34;is_approved\u0026#34;: true,\r\u0026#34;is_public\u0026#34;: true,\r\u0026#34;approval_type\u0026#34;: \u0026#34;auto_rating\u0026#34;\r}\r}\rResponse (Not approved):\r{\r\u0026#34;success\u0026#34;: true,\r\u0026#34;rating_saved\u0026#34;: true,\r\u0026#34;average_rating\u0026#34;: 3.5,\r\u0026#34;rating_count\u0026#34;: 8,\r\u0026#34;auto_approved\u0026#34;: false,\r\u0026#34;message\u0026#34;: \u0026#34;Cáº£m Æ¡n Ä‘Ã¡nh giÃ¡ cá»§a báº¡n!\u0026#34;\r}Luá»“ng Validate Ingredients:\nPOST /ingredients/validate\rAuthorization: Bearer \u0026lt;JWT\u0026gt;\rBody: {\r\u0026#34;ingredients\u0026#34;: [\u0026#34;cÃ¡ rÃ´\u0026#34;, \u0026#34;abc xyz\u0026#34;, \u0026#34;thit ga\u0026#34;]\r}\rResponse:\r{\r\u0026#34;valid\u0026#34;: [\u0026#34;cÃ¡ rÃ´\u0026#34;],\r\u0026#34;invalid\u0026#34;: [\u0026#34;abc xyz\u0026#34;],\r\u0026#34;corrected\u0026#34;: [\r{\r\u0026#34;original\u0026#34;: \u0026#34;thit ga\u0026#34;,\r\u0026#34;matched\u0026#34;: \u0026#34;thá»‹t gÃ \u0026#34;,\r\u0026#34;confidence\u0026#34;: 0.85\r}\r],\r\u0026#34;suggestions\u0026#34;: [\r{\r\u0026#34;original\u0026#34;: \u0026#34;abc xyz\u0026#34;,\r\u0026#34;similar\u0026#34;: [\u0026#34;gÃ \u0026#34;, \u0026#34;cÃ¡\u0026#34;, \u0026#34;bÃ²\u0026#34;, \u0026#34;tÃ´m\u0026#34;, \u0026#34;má»±c\u0026#34;]\r}\r]\r}Endpoints Quyá»n RiÃªng TÆ° \u0026amp; XÃ£ Há»™i:\nPUT /user/privacy - Cáº­p nháº­t cÃ i Ä‘áº·t quyá»n riÃªng tÆ°\rGET /user/profile/{userId} - Láº¥y há»“ sÆ¡ (Ä‘Ã£ lá»c quyá»n riÃªng tÆ°)\rPOST /friends/request - Gá»­i yÃªu cáº§u káº¿t báº¡n\rGET /friends - Danh sÃ¡ch báº¡n bÃ¨Endpoints Quáº£n Trá»‹:\nGET /admin/users - Danh sÃ¡ch táº¥t cáº£ ngÆ°á»i dÃ¹ng (chá»‰ admin)\rPUT /admin/users/{id}/ban - Cáº¥m ngÆ°á»i dÃ¹ng (chá»‰ admin)\rGET /admin/statistics - Thá»‘ng kÃª há»‡ thá»‘ng (chá»‰ admin)\rGET /admin/recipes/pending - CÃ´ng thá»©c chá» approval (Ã­t sá»­ dá»¥ng do auto-approval)Endpoints Má»›i - Social Features:\nPOST /posts - Táº¡o bÃ i Ä‘Äƒng\rGET /posts/feed - Láº¥y newsfeed\rPOST /posts/{id}/comments - BÃ¬nh luáº­n\rPOST /reactions - ThÃªm reaction\rGET /notifications - Láº¥y thÃ´ng bÃ¡oğŸ”’ QUYá»€N RIÃŠNG TÆ¯ \u0026amp; Báº¢O Máº¬T#\rCÃ¡c Má»©c Quyá»n RiÃªng TÆ°#\rPublic: Má»i ngÆ°á»i cÃ³ thá»ƒ xem Friends: Chá»‰ báº¡n bÃ¨ Ä‘Ã£ cháº¥p nháº­n cÃ³ thá»ƒ xem Private: Chá»‰ ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ xem Thuá»™c TÃ­nh ÄÆ°á»£c Kiá»ƒm SoÃ¡t Quyá»n RiÃªng TÆ°#\rEmail (máº·c Ä‘á»‹nh: private) NgÃ y sinh (máº·c Ä‘á»‹nh: friends) Giá»›i tÃ­nh (máº·c Ä‘á»‹nh: public) Quá»‘c gia (máº·c Ä‘á»‹nh: public) CÃ´ng thá»©c (máº·c Ä‘á»‹nh: public) NguyÃªn liá»‡u (máº·c Ä‘á»‹nh: friends) Sá»Ÿ thÃ­ch (máº·c Ä‘á»‹nh: friends) Kiá»ƒm SoÃ¡t Truy Cáº­p Theo Vai TrÃ²#\rUser: Truy cáº­p thÃ´ng thÆ°á»ng Admin: Truy cáº­p Ä‘áº§y Ä‘á»§ + cÃ´ng cá»¥ quáº£n trá»‹ Thá»i Gian \u0026amp; Má»‘c Quan Trá»ng#\rXem HÆ°á»›ng Dáº«n Triá»ƒn Khai KhÃ¡ch HÃ ng Ä‘á»ƒ biáº¿t thá»i gian chi tiáº¿t.\n"},{"id":3,"href":"/docs/summary/database-diagram/","title":"Database Schema Diagram","section":"Summary","content":"SÆ¡ Äá»“ Cáº¥u TrÃºc CÆ¡ Sá»Ÿ Dá»¯ Liá»‡u#\rERD (SÆ¡ Äá»“ Quan Há»‡ Thá»±c Thá»ƒ)#\r// Báº£ng NgÆ°á»i DÃ¹ng (AI sá»­ dá»¥ng: birth_year, gender, country)\rTable users {\ruser_id varchar(36) [pk, note: \u0026#39;UUID tá»« Cognito\u0026#39;]\remail varchar(255) [unique, not null]\rusername varchar(50) [unique, not null]\rfull_name varchar(100)\rdate_of_birth date [note: \u0026#39;AI dÃ¹ng Ä‘á»ƒ tÃ­nh tuá»•i â†’ khuyáº¿n nghá»‹ dinh dÆ°á»¡ng phÃ¹ há»£p\u0026#39;]\rgender enum(\u0026#39;male\u0026#39;, \u0026#39;female\u0026#39;, \u0026#39;other\u0026#39;) [note: \u0026#39;AI dÃ¹ng Ä‘á»ƒ khuyáº¿n nghá»‹ kháº©u pháº§n\u0026#39;]\rcountry varchar(50) [note: \u0026#39;AI Æ°u tiÃªn mÃ³n Äƒn Ä‘á»‹a phÆ°Æ¡ng (VD: Vietnam â†’ mÃ³n Viá»‡t)\u0026#39;]\ravatar_url varchar(500)\rrole enum(\u0026#39;user\u0026#39;, \u0026#39;admin\u0026#39;) [default: \u0026#39;user\u0026#39;]\ris_active boolean [default: true]\rcreated_at timestamp [default: `now()`]\rupdated_at timestamp [default: `now()`]\rlast_login timestamp\rindexes {\remail\rusername\rrole\r}\rNote: \u0026#39;\u0026#39;\u0026#39;\r**AI Agent Privacy Policy:**\rAI chá»‰ sá»­ dá»¥ng: nÄƒm sinh (age range), giá»›i tÃ­nh, quá»‘c gia\rMá»¥c Ä‘Ã­ch: CÃ¡ nhÃ¢n hÃ³a gá»£i Ã½ mÃ³n Äƒn\rKHÃ”NG sá»­ dá»¥ng: Email, tÃªn Ä‘áº§y Ä‘á»§, Ä‘á»‹a chá»‰ cá»¥ thá»ƒ\r\u0026#39;\u0026#39;\u0026#39;\r}\r// TÃ¹y Chá»n NgÆ°á»i DÃ¹ng (Sá»­ dá»¥ng bá»Ÿi AI Agent)\rTable user_preferences {\rpreference_id varchar(36) [pk]\ruser_id varchar(36) [ref: \u0026gt; users.user_id, not null]\rdietary_restrictions json [note: \u0026#39;chay, thuáº§n chay, halal, kosher, v.v.\u0026#39;]\rallergies json [note: \u0026#39;Danh sÃ¡ch dá»‹ á»©ng - AI TRÃNH TUYá»†T Äá»I cÃ¡c nguyÃªn liá»‡u nÃ y\u0026#39;]\rfavorite_cuisines json [note: \u0026#39;Ã, Viá»‡t Nam, Nháº­t Báº£n - AI Æ°u tiÃªn mÃ³n quá»‘c gia nÃ y\u0026#39;]\rpreferred_cooking_methods json [note: \u0026#39;xÃ o, háº¥p, canh, kho, chiÃªn - AI Æ°u tiÃªn phÆ°Æ¡ng phÃ¡p nÃ y khi suggest\u0026#39;]\rpreferred_recipe_count int [default: 1, note: \u0026#39;1-5 mÃ³n muá»‘n náº¥u má»—i láº§n, FREE: 1, PREMIUM: 5\u0026#39;]\rspice_level enum(\u0026#39;none\u0026#39;, \u0026#39;mild\u0026#39;, \u0026#39;medium\u0026#39;, \u0026#39;hot\u0026#39;, \u0026#39;very_hot\u0026#39;)\rcreated_at timestamp [default: `now()`]\rupdated_at timestamp [default: `now()`]\rNote: \u0026#39;\u0026#39;\u0026#39;\r**AI Agent sá»­ dá»¥ng fields:**\r- allergies: Filter recipe ingredients (báº£o vá»‡ an toÃ n thá»±c pháº©m)\r- favorite_cuisines: Æ¯u tiÃªn mÃ³n Ã/Viá»‡t/... (personalization)\r- preferred_cooking_methods: Æ¯u tiÃªn canh/háº¥p/chiÃªn/... (Ä‘a dáº¡ng mÃ³n)\r**Privacy Policy:**\r- Chá»‰ sá»­ dá»¥ng cho personalization gá»£i Ã½ mÃ³n Äƒn\r- KHÃ”NG chia sáº» hoáº·c khai thÃ¡c thÃ´ng tin cÃ¡ nhÃ¢n\r\u0026#39;\u0026#39;\u0026#39;\r}\r// CÃ i Äáº·t Quyá»n RiÃªng TÆ°\rTable privacy_settings {\rsetting_id varchar(36) [pk]\ruser_id varchar(36) [ref: \u0026gt; users.user_id, not null, unique]\rprofile_visibility enum(\u0026#39;public\u0026#39;, \u0026#39;friends\u0026#39;, \u0026#39;private\u0026#39;) [default: \u0026#39;public\u0026#39;, note: \u0026#39;Ai cÃ³ thá»ƒ xem há»“ sÆ¡\u0026#39;]\remail_visibility enum(\u0026#39;public\u0026#39;, \u0026#39;friends\u0026#39;, \u0026#39;private\u0026#39;) [default: \u0026#39;private\u0026#39;]\rdate_of_birth_visibility enum(\u0026#39;public\u0026#39;, \u0026#39;friends\u0026#39;, \u0026#39;private\u0026#39;) [default: \u0026#39;friends\u0026#39;]\rgender_visibility enum(\u0026#39;public\u0026#39;, \u0026#39;friends\u0026#39;, \u0026#39;private\u0026#39;) [default: \u0026#39;public\u0026#39;]\rcountry_visibility enum(\u0026#39;public\u0026#39;, \u0026#39;friends\u0026#39;, \u0026#39;private\u0026#39;) [default: \u0026#39;public\u0026#39;]\rrecipes_visibility enum(\u0026#39;public\u0026#39;, \u0026#39;friends\u0026#39;, \u0026#39;private\u0026#39;) [default: \u0026#39;public\u0026#39;]\ringredients_visibility enum(\u0026#39;public\u0026#39;, \u0026#39;friends\u0026#39;, \u0026#39;private\u0026#39;) [default: \u0026#39;friends\u0026#39;]\rpreferences_visibility enum(\u0026#39;public\u0026#39;, \u0026#39;friends\u0026#39;, \u0026#39;private\u0026#39;) [default: \u0026#39;friends\u0026#39;]\rcreated_at timestamp [default: `now()`]\rupdated_at timestamp [default: `now()`]\rindexes {\ruser_id\r}\r}\r// Quan Há»‡ Báº¡n BÃ¨\rTable friendships {\rfriendship_id varchar(36) [pk]\ruser_id varchar(36) [ref: \u0026gt; users.user_id, not null]\rfriend_id varchar(36) [ref: \u0026gt; users.user_id, not null]\rstatus enum(\u0026#39;pending\u0026#39;, \u0026#39;accepted\u0026#39;, \u0026#39;blocked\u0026#39;) [default: \u0026#39;pending\u0026#39;]\rrequested_at timestamp [default: `now()`]\rresponded_at timestamp\rindexes {\r(user_id, friend_id) [unique]\ruser_id\rfriend_id\rstatus\r}\r}\r// NguyÃªn Liá»‡u NgÆ°á»i DÃ¹ng (Danh sÃ¡ch Ä‘Æ¡n giáº£n - khÃ´ng theo dÃµi sá»‘ lÆ°á»£ng)\rTable user_ingredients {\ringredient_id varchar(36) [pk]\ruser_id varchar(36) [ref: \u0026gt; users.user_id, not null]\ringredient_name varchar(256) [not null]\radded_at timestamp [default: `now()`]\rindexes {\r(user_id, ingredient_name) [unique]\r}\r}\r// CÃ´ng Thá»©c (Do ngÆ°á»i dÃ¹ng táº¡o \u0026amp; AI táº¡o)\rTable recipes {\rrecipe_id varchar(36) [pk]\ruser_id varchar(36) [ref: \u0026gt; users.user_id, note: \u0026#39;NgÆ°á»i táº¡o - null náº¿u lÃ  cÃ´ng thá»©c há»‡ thá»‘ng\u0026#39;]\rtitle varchar(200) [not null]\rnormalized_title varchar(200) [note: \u0026#39;Chá»¯ thÆ°á»ng, khÃ´ng dáº¥u Ä‘á»ƒ tÃ¬m kiáº¿m\u0026#39;]\rdescription text\rcuisine_type varchar(50)\rcooking_method varchar(50) [note: \u0026#39;xÃ o, háº¥p, luá»™c, chiÃªn, nÆ°á»›ng, kho, rim, trá»™n, canh, láº©u\u0026#39;]\rmeal_type varchar(50) [note: \u0026#39;mÃ³n chÃ­nh, mÃ³n phá»¥, canh, khai vá»‹, trÃ¡ng miá»‡ng\u0026#39;]\rprep_time_minutes int\rcook_time_minutes int\rservings int\rcalories_per_serving int\rinstructions json [note: \u0026#39;Máº£ng cÃ¡c Ä‘á»‘i tÆ°á»£ng bÆ°á»›c\u0026#39;]\ris_public boolean [default: false]\ris_ai_generated boolean [default: false]\ris_approved boolean [default: false, note: \u0026#39;Auto-approved náº¿u rating \u0026gt;= 4 sao\u0026#39;]\rapproval_type enum(\u0026#39;manual\u0026#39;, \u0026#39;auto_rating\u0026#39;, \u0026#39;auto_popular\u0026#39;, \u0026#39;system\u0026#39;) [note: \u0026#39;CÃ¡ch thá»©c approval\u0026#39;]\raverage_rating decimal(2,1) [default: 0.0, note: \u0026#39;Rating trung bÃ¬nh\u0026#39;]\rrating_count int [default: 0, note: \u0026#39;Sá»‘ lÆ°á»£ng Ä‘Ã¡nh giÃ¡\u0026#39;]\rai_cache_hit_count int [default: 0, note: \u0026#39;Sá»‘ láº§n tÃ¡i sá»­ dá»¥ng tá»« cache\u0026#39;]\rcreated_at timestamp [default: `now()`]\rupdated_at timestamp [default: `now()`]\rapproved_at timestamp [note: \u0026#39;Thá»i Ä‘iá»ƒm Ä‘Æ°á»£c approve\u0026#39;]\rindexes {\ruser_id\rnormalized_title\rcuisine_type\rcooking_method\rmeal_type\ris_approved\raverage_rating\r}\r}\r// Bá»™ Nhá»› Cache CÃ´ng Thá»©c (CÃ´ng thá»©c AI táº¡o Ä‘á»ƒ tÃ¡i sá»­ dá»¥ng)\rTable recipe_cache {\rcache_id varchar(36) [pk]\rrecipe_name varchar(200) [not null]\rnormalized_name varchar(200) [unique, not null, note: \u0026#39;KhÃ³a tÃ¬m kiáº¿m\u0026#39;]\rrecipe_data json [note: \u0026#39;JSON cÃ´ng thá»©c Ä‘áº§y Ä‘á»§ tá»« AI\u0026#39;]\ringredients_hash varchar(64) [note: \u0026#39;Hash cá»§a danh sÃ¡ch nguyÃªn liá»‡u\u0026#39;]\rcuisine_type varchar(50)\rhit_count int [default: 0, note: \u0026#39;Bá»™ Ä‘áº¿m tÃ¡i sá»­ dá»¥ng\u0026#39;]\rlast_accessed timestamp\rcreated_at timestamp [default: `now()`]\rindexes {\rnormalized_name\ringredients_hash\rcuisine_type\r}\r}\r// NguyÃªn Liá»‡u CÃ´ng Thá»©c\rTable recipe_ingredients {\rid varchar(36) [pk]\rrecipe_id varchar(36) [ref: \u0026gt; recipes.recipe_id, not null]\ringredient_name varchar(100) [not null]\rquantity varchar(50) [note: \u0026#39;2 chÃ©n, 500g, v.v.\u0026#39;]\runit varchar(20)\ris_optional boolean [default: false]\rindexes {\rrecipe_id\r}\r}\r// Lá»‹ch Sá»­ Gá»£i Ã AI (Enhanced)\rTable ai_suggestions {\rsuggestion_id varchar(36) [pk]\ruser_id varchar(36) [ref: \u0026gt; users.user_id, not null]\rrecipe_id varchar(36) [ref: \u0026gt; recipes.recipe_id]\rcache_id varchar(36) [ref: \u0026gt; recipe_cache.cache_id, note: \u0026#39;Náº¿u tá»« cache\u0026#39;]\rprompt_text text [note: \u0026#39;Äáº§u vÃ o cá»§a ngÆ°á»i dÃ¹ng cho AI\u0026#39;]\ringredients_used json [note: \u0026#39;Danh sÃ¡ch nguyÃªn liá»‡u tá»« user_ingredients\u0026#39;]\rrequested_recipe_count int [default: 1, note: \u0026#39;1-5 mÃ³n user yÃªu cáº§u\u0026#39;]\rrecipes_from_db int [default: 0, note: \u0026#39;Sá»‘ mÃ³n tá»« database\u0026#39;]\rrecipes_from_ai int [default: 0, note: \u0026#39;Sá»‘ mÃ³n AI táº¡o má»›i\u0026#39;]\rinvalid_ingredients json [note: \u0026#39;NguyÃªn liá»‡u khÃ´ng há»£p lá»‡ - logged\u0026#39;]\rai_response json [note: \u0026#39;Pháº£n há»“i AI Ä‘áº§y Ä‘á»§\u0026#39;]\rwas_from_cache boolean [default: false, note: \u0026#39;True náº¿u tÃ¡i sá»­ dá»¥ng tá»« cache\u0026#39;]\rwas_accepted boolean [default: false]\rfeedback_rating int [note: \u0026#39;1-5 sao\u0026#39;]\rfeedback_comment text\rcreated_at timestamp [default: `now()`]\rindexes {\ruser_id\rcreated_at\rcache_id\r}\r}\r// Lá»‹ch Sá»­ Náº¥u Ä‚n CÃ¡ NhÃ¢n (Thay tháº¿ favorites - má»Ÿ rá»™ng hÆ¡n)\rTable user_cooking_history {\rhistory_id varchar(36) [pk]\ruser_id varchar(36) [ref: \u0026gt; users.user_id, not null]\rrecipe_id varchar(36) [ref: \u0026gt; recipes.recipe_id, not null]\rsuggestion_id varchar(36) [ref: \u0026gt; ai_suggestions.suggestion_id, note: \u0026#39;Náº¿u tá»« AI suggestion\u0026#39;]\rstatus enum(\u0026#39;planned\u0026#39;, \u0026#39;cooking\u0026#39;, \u0026#39;completed\u0026#39;, \u0026#39;failed\u0026#39;) [default: \u0026#39;planned\u0026#39;]\rpersonal_rating int [note: \u0026#39;1-5 sao - Ä‘Ã¡nh giÃ¡ cÃ¡ nhÃ¢n\u0026#39;]\rpersonal_notes text [note: \u0026#39;Ghi chÃº cÃ¡ nhÃ¢n\u0026#39;]\ris_favorite boolean [default: false, note: \u0026#39;ÄÃ¡nh dáº¥u yÃªu thÃ­ch\u0026#39;]\rcook_date timestamp [note: \u0026#39;NgÃ y náº¥u thá»±c táº¿\u0026#39;]\rcreated_at timestamp [default: `now()`]\rupdated_at timestamp [default: `now()`]\rindexes {\ruser_id\rrecipe_id\rstatus\ris_favorite\rcook_date\r(user_id, recipe_id) [note: \u0026#39;Cho phÃ©p multiple entries - lá»‹ch sá»­ náº¥u nhiá»u láº§n\u0026#39;]\r}\r}\r// ÄÃ¡nh GiÃ¡ CÃ´ng Thá»©c (Cho auto-approval system)\rTable recipe_ratings {\rrating_id varchar(36) [pk]\rrecipe_id varchar(36) [ref: \u0026gt; recipes.recipe_id, not null]\ruser_id varchar(36) [ref: \u0026gt; users.user_id, not null]\rhistory_id varchar(36) [ref: \u0026gt; user_cooking_history.history_id, note: \u0026#39;Link Ä‘áº¿n lá»‹ch sá»­ náº¥u\u0026#39;]\rrating int [not null, note: \u0026#39;1-5 sao\u0026#39;]\rcomment text\ris_verified_cook boolean [default: false, note: \u0026#39;User Ä‘Ã£ thá»±c sá»± náº¥u mÃ³n nÃ y\u0026#39;]\rcreated_at timestamp [default: `now()`]\rupdated_at timestamp [default: `now()`]\rindexes {\rrecipe_id\ruser_id\rrating\r(recipe_id, user_id) [unique, note: \u0026#39;Má»—i user chá»‰ rate 1 láº§n má»—i recipe\u0026#39;]\r}\r}\r// Káº¿ Hoáº¡ch Bá»¯a Ä‚n\rTable meal_plans {\rplan_id varchar(36) [pk]\ruser_id varchar(36) [ref: \u0026gt; users.user_id, not null]\rplan_name varchar(100)\rstart_date date [not null]\rend_date date [not null]\ris_active boolean [default: true]\rcreated_at timestamp [default: `now()`]\rindexes {\ruser_id\rstart_date\r}\r}\r// Má»¥c Káº¿ Hoáº¡ch Bá»¯a Ä‚n\rTable meal_plan_items {\ritem_id varchar(36) [pk]\rplan_id varchar(36) [ref: \u0026gt; meal_plans.plan_id, not null]\rrecipe_id varchar(36) [ref: \u0026gt; recipes.recipe_id, not null]\rmeal_date date [not null]\rmeal_type enum(\u0026#39;breakfast\u0026#39;, \u0026#39;lunch\u0026#39;, \u0026#39;dinner\u0026#39;, \u0026#39;snack\u0026#39;)\rnotes text\rindexes {\rplan_id\rmeal_date\r}\r}\r// Master Ingredients (Danh sÃ¡ch nguyÃªn liá»‡u há»£p lá»‡ cho AI validation)\rTable master_ingredients {\ringredient_id varchar(36) [pk]\rname varchar(256) [unique, not null]\rnormalized_name varchar(256) [unique, not null, note: \u0026#39;KhÃ´ng dáº¥u, chá»¯ thÆ°á»ng - cho fuzzy search\u0026#39;]\rcategory varchar(50) [note: \u0026#39;thá»‹t, rau, gia vá»‹, sá»¯a, v.v.\u0026#39;]\raliases json [note: \u0026#39;CÃ¡c tÃªn gá»i khÃ¡c: [\u0026#34;thá»‹t bÃ²\u0026#34;, \u0026#34;bÃ²\u0026#34;, \u0026#34;beef\u0026#34;] - há»— trá»£ auto-correct\u0026#39;]\ris_active boolean [default: true]\rcreated_at timestamp [default: `now()`]\rupdated_at timestamp [default: `now()`]\rindexes {\rnormalized_name\rcategory\ris_active\r}\rNote: \u0026#39;\u0026#39;\u0026#39;\r**AI Agent Validation Flow:**\r1. User nháº­p nguyÃªn liá»‡u â†’ normalize (bá» dáº¥u, lowercase)\r2. Check exact match vá»›i normalized_name\r3. Náº¿u khÃ´ng match â†’ fuzzy search trong aliases\r4. Náº¿u váº«n khÃ´ng â†’ gá»£i Ã½ nguyÃªn liá»‡u tÆ°Æ¡ng tá»± (category match)\r5. Log invalid ingredients â†’ report cho admin\r**Káº¿t ná»‘i vá»›i AI Agent:**\r- validateIngredientsWithMaster() function\r- TrÃ¡nh AI hallucination vá» tÃªn nguyÃªn liá»‡u\r- Äáº£m báº£o recipe accuracy\r\u0026#39;\u0026#39;\u0026#39;\r}\r// Nháº­t KÃ½ Hoáº¡t Äá»™ng NgÆ°á»i DÃ¹ng (Enhanced vá»›i invalid ingredient tracking)\rTable activity_logs {\rlog_id varchar(36) [pk]\ruser_id varchar(36) [ref: \u0026gt; users.user_id, not null]\ractivity_type enum(\u0026#39;login\u0026#39;, \u0026#39;recipe_view\u0026#39;, \u0026#39;recipe_create\u0026#39;, \u0026#39;ai_suggestion\u0026#39;, \u0026#39;ingredient_add\u0026#39;, \u0026#39;recipe_cook\u0026#39;, \u0026#39;recipe_rate\u0026#39;, \u0026#39;invalid_ingredient\u0026#39;)\ractivity_data json\rip_address varchar(45)\ruser_agent text\rcreated_at timestamp [default: `now()`]\rindexes {\ruser_id\rcreated_at\ractivity_type\r}\r}\r// Invalid Ingredients Reports (Optional - Post MVP)\rTable invalid_ingredients_reports {\rreport_id varchar(36) [pk]\ringredient_name varchar(256) [not null]\rnormalized_name varchar(256) [not null, note: \u0026#39;Chá»¯ thÆ°á»ng, khÃ´ng dáº¥u\u0026#39;]\ruser_id varchar(36) [ref: \u0026gt; users.user_id, not null]\ruser_report_count int [default: 1, note: \u0026#39;Sá»‘ láº§n user nÃ y report\u0026#39;]\rtotal_reports int [default: 1, note: \u0026#39;Tá»•ng sá»‘ reports tá»« táº¥t cáº£ users\u0026#39;]\rstatus enum(\u0026#39;pending\u0026#39;, \u0026#39;reviewed\u0026#39;, \u0026#39;added_to_master\u0026#39;, \u0026#39;spam\u0026#39;) [default: \u0026#39;pending\u0026#39;]\radmin_notes text\rcreated_at timestamp [default: `now()`]\rupdated_at timestamp [default: `now()`]\rindexes {\r(normalized_name, user_id) [unique]\rtotal_reports\rstatus\r}\r}\r// BÃ i ÄÄƒng (Posts)\rTable posts {\rpost_id varchar(36) [pk]\ruser_id varchar(36) [ref: \u0026gt; users.user_id, not null]\rrecipe_id varchar(36) [ref: \u0026gt; recipes.recipe_id, note: \u0026#39;Optional - náº¿u chia sáº» cÃ´ng thá»©c\u0026#39;]\rcontent text [note: \u0026#39;Ná»™i dung bÃ i Ä‘Äƒng\u0026#39;]\rimages json [note: \u0026#39;Máº£ng URLs áº£nh\u0026#39;]\ris_public boolean [default: true]\rlikes_count int [default: 0]\rcomments_count int [default: 0]\rcreated_at timestamp [default: `now()`]\rupdated_at timestamp [default: `now()`]\rindexes {\ruser_id\rrecipe_id\rcreated_at\ris_public\r}\r}\r// BÃ¬nh Luáº­n (Comments)\rTable comments {\rcomment_id varchar(36) [pk]\rpost_id varchar(36) [ref: \u0026gt; posts.post_id, not null]\ruser_id varchar(36) [ref: \u0026gt; users.user_id, not null]\rparent_comment_id varchar(36) [ref: \u0026gt; comments.comment_id, note: \u0026#39;Cho reply/thread\u0026#39;]\rcontent text [not null]\rcreated_at timestamp [default: `now()`]\rupdated_at timestamp [default: `now()`]\rindexes {\rpost_id\ruser_id\rparent_comment_id\rcreated_at\r}\r}\r// LÆ°á»£t ThÃ­ch/Reactions\rTable reactions {\rreaction_id varchar(36) [pk]\ruser_id varchar(36) [ref: \u0026gt; users.user_id, not null]\rtarget_type enum(\u0026#39;post\u0026#39;, \u0026#39;recipe\u0026#39;, \u0026#39;comment\u0026#39;) [not null]\rtarget_id varchar(36) [not null, note: \u0026#39;ID cá»§a post/recipe/comment\u0026#39;]\rreaction_type enum(\u0026#39;like\u0026#39;, \u0026#39;love\u0026#39;, \u0026#39;wow\u0026#39;, \u0026#39;sad\u0026#39;, \u0026#39;angry\u0026#39;) [default: \u0026#39;like\u0026#39;]\rcreated_at timestamp [default: `now()`]\rindexes {\r(user_id, target_type, target_id) [unique]\rtarget_type\rtarget_id\ruser_id\r}\r}\r// ThÃ´ng BÃ¡o (Notifications)\rTable notifications {\rnotification_id varchar(36) [pk]\ruser_id varchar(36) [ref: \u0026gt; users.user_id, not null]\ractor_id varchar(36) [ref: \u0026gt; users.user_id, note: \u0026#39;NgÆ°á»i thá»±c hiá»‡n hÃ nh Ä‘á»™ng\u0026#39;]\rtype enum(\u0026#39;friend_request\u0026#39;, \u0026#39;friend_accept\u0026#39;, \u0026#39;comment\u0026#39;, \u0026#39;like\u0026#39;, \u0026#39;mention\u0026#39;, \u0026#39;recipe_share\u0026#39;) [not null]\rtarget_type enum(\u0026#39;post\u0026#39;, \u0026#39;recipe\u0026#39;, \u0026#39;comment\u0026#39;, \u0026#39;friend_request\u0026#39;) [not null]\rtarget_id varchar(36) [not null]\rcontent text [note: \u0026#39;Ná»™i dung thÃ´ng bÃ¡o\u0026#39;]\ris_read boolean [default: false]\rcreated_at timestamp [default: `now()`]\rindexes {\ruser_id\ris_read\rcreated_at\rtype\r}\r}\r// NgÆ°á»i Theo DÃµi (Followers) - Náº¿u muá»‘n mÃ´ hÃ¬nh follow ngoÃ i friendship\rTable user_followers {\rfollow_id varchar(36) [pk]\rfollower_id varchar(36) [ref: \u0026gt; users.user_id, not null, note: \u0026#39;NgÆ°á»i theo dÃµi\u0026#39;]\rfollowing_id varchar(36) [ref: \u0026gt; users.user_id, not null, note: \u0026#39;NgÆ°á»i Ä‘Æ°á»£c theo dÃµi\u0026#39;]\rcreated_at timestamp [default: `now()`]\rindexes {\r(follower_id, following_id) [unique]\rfollower_id\rfollowing_id\r}\r}CÃ´ng Nghá»‡ CÆ¡ Sá»Ÿ Dá»¯ Liá»‡u#\rCÆ¡ Sá»Ÿ Dá»¯ Liá»‡u ChÃ­nh: Amazon DynamoDB (NoSQL)\nKháº£ nÄƒng má»Ÿ rá»™ng cao Äá»™ trá»… tháº¥p Serverless (khÃ´ng cáº§n quáº£n lÃ½ háº¡ táº§ng) Hiá»‡u quáº£ chi phÃ­ cho khá»‘i lÆ°á»£ng cÃ´ng viá»‡c Ä‘á»c nhiá»u PhÆ°Æ¡ng Ãn Thay Tháº¿: Amazon RDS PostgreSQL\nNáº¿u cáº§n cÃ¡c truy váº¥n quan há»‡ phá»©c táº¡p Tá»‘t hÆ¡n cho phÃ¢n tÃ­ch vÃ  bÃ¡o cÃ¡o Máº«u Truy Cáº­p Dá»¯ Liá»‡u#\rMáº«u Truy Cáº­p ChÃ­nh (Enhanced)#\rLáº¥y Há»“ SÆ¡ NgÆ°á»i DÃ¹ng: users.user_id â†’ Dá»¯ liá»‡u ngÆ°á»i dÃ¹ng + vai trÃ² Láº¥y TÃ¹y Chá»n NgÆ°á»i DÃ¹ng: user_preferences.user_id â†’ TÃ¹y chá»n + preferred_recipe_count Láº¥y NguyÃªn Liá»‡u NgÆ°á»i DÃ¹ng: user_ingredients.user_id â†’ Danh sÃ¡ch nguyÃªn liá»‡u Validate NguyÃªn Liá»‡u: master_ingredients.normalized_name â†’ Kiá»ƒm tra há»£p lá»‡ Láº¥y CÃ i Äáº·t Quyá»n RiÃªng TÆ°: privacy_settings.user_id â†’ Cáº¥u hÃ¬nh riÃªng tÆ° Kiá»ƒm Tra Quan Há»‡ Báº¡n BÃ¨: friendships(user_id, friend_id) â†’ Tráº¡ng thÃ¡i báº¡n bÃ¨ Láº¥y Danh SÃ¡ch Báº¡n BÃ¨: friendships.user_id â†’ Táº¥t cáº£ báº¡n bÃ¨ Láº¥y Chi Tiáº¿t CÃ´ng Thá»©c: recipes.recipe_id â†’ CÃ´ng thá»©c + NguyÃªn liá»‡u Láº¥y CÃ´ng Thá»©c ÄÃ£ Duyá»‡t: recipes.is_approved=true â†’ CÃ´ng thá»©c cÃ´ng khai Query Recipes by Category: recipes.cooking_method + meal_type â†’ Diverse suggestions â­ Láº¥y Gá»£i Ã AI: ai_suggestions.user_id + created_at â†’ Gá»£i Ã½ gáº§n Ä‘Ã¢y Láº¥y Lá»‹ch Sá»­ Náº¥u Ä‚n: user_cooking_history.user_id â†’ Lá»‹ch sá»­ cÃ¡ nhÃ¢n Láº¥y MÃ³n YÃªu ThÃ­ch: user_cooking_history.user_id + is_favorite=true â†’ MÃ³n yÃªu thÃ­ch Láº¥y ÄÃ¡nh GiÃ¡ CÃ´ng Thá»©c: recipe_ratings.recipe_id â†’ Táº¥t cáº£ rating TÃ­nh ToÃ¡n Auto-Approval: recipe_ratings.recipe_id + rating\u0026gt;=4 â†’ Kiá»ƒm tra Ä‘iá»u kiá»‡n Log Invalid Ingredients: activity_logs.activity_type=\u0026lsquo;invalid_ingredient\u0026rsquo; â†’ CloudWatch â­ Admin: Top Invalid Reports: invalid_ingredients_reports.total_reports â†’ Admin dashboard â­ Láº¥y BÃ i ÄÄƒng NgÆ°á»i DÃ¹ng: posts.user_id + created_at â†’ Danh sÃ¡ch bÃ i Ä‘Äƒng Láº¥y Newsfeed: posts(báº¡n bÃ¨) + created_at â†’ BÃ i Ä‘Äƒng cá»§a báº¡n bÃ¨ Láº¥y BÃ¬nh Luáº­n: comments.post_id + created_at â†’ BÃ¬nh luáº­n cá»§a bÃ i Ä‘Äƒng Láº¥y Reactions: reactions(target_type, target_id) â†’ LÆ°á»£t thÃ­ch/reactions Láº¥y ThÃ´ng BÃ¡o: notifications.user_id + is_read â†’ ThÃ´ng bÃ¡o chÆ°a Ä‘á»c Láº¥y Followers: user_followers.following_id â†’ Danh sÃ¡ch ngÆ°á»i theo dÃµi Máº«u Thá»© Cáº¥p#\rTÃ¬m kiáº¿m cÃ´ng thá»©c theo mÃ³n Äƒn/phÆ°Æ¡ng phÃ¡p (vá»›i lá»c quyá»n riÃªng tÆ°) Láº¥y cÃ´ng thá»©c cÃ´ng khai phá»• biáº¿n Quáº£n trá»‹: Láº¥y táº¥t cáº£ ngÆ°á»i dÃ¹ng vá»›i bá»™ lá»c vai trÃ² Quáº£n trá»‹: Láº¥y thá»‘ng kÃª ngÆ°á»i dÃ¹ng Truy váº¥n phÃ¢n tÃ­ch (nháº­t kÃ½ hoáº¡t Ä‘á»™ng) Thiáº¿t Káº¿ Báº£ng DynamoDB (Máº«u Báº£ng ÄÆ¡n)#\rBáº£ng ChÃ­nh: smart-cooking-data#\rNgÆ°á»i DÃ¹ng#\rPK: USER#\u0026lt;user_id\u0026gt; SK: PROFILE Thuá»™c tÃ­nh: email, username, full_name, role, is_active, v.v. GSI1PK: ROLE#\u0026lt;role\u0026gt; (cho truy váº¥n quáº£n trá»‹) TÃ¹y Chá»n NgÆ°á»i DÃ¹ng#\rPK: USER#\u0026lt;user_id\u0026gt; SK: PREFERENCES Thuá»™c tÃ­nh: dietary_restrictions, allergies, favorite_cuisines, v.v. CÃ i Äáº·t Quyá»n RiÃªng TÆ°#\rPK: USER#\u0026lt;user_id\u0026gt; SK: PRIVACY Thuá»™c tÃ­nh: profile_visibility, email_visibility, v.v. NguyÃªn Liá»‡u NgÆ°á»i DÃ¹ng#\rPK: USER#\u0026lt;user_id\u0026gt; SK: INGREDIENT#\u0026lt;ingredient_name\u0026gt; Thuá»™c tÃ­nh: category, added_at Quan Há»‡ Báº¡n BÃ¨#\rPK: USER#\u0026lt;user_id\u0026gt; SK: FRIEND#\u0026lt;friend_id\u0026gt; Thuá»™c tÃ­nh: status, requested_at, responded_at GSI1PK: USER#\u0026lt;friend_id\u0026gt; (Ä‘á»ƒ tra cá»©u ngÆ°á»£c) GSI1SK: FRIEND#\u0026lt;user_id\u0026gt; CÃ´ng Thá»©c#\rPK: RECIPE#\u0026lt;recipe_id\u0026gt; SK: METADATA Thuá»™c tÃ­nh: title, description, cuisine_type, difficulty, v.v. GSI1PK: USER#\u0026lt;user_id\u0026gt; (cÃ´ng thá»©c cá»§a ngÆ°á»i dÃ¹ng) GSI1SK: RECIPE#\u0026lt;created_at\u0026gt; NguyÃªn Liá»‡u CÃ´ng Thá»©c#\rPK: RECIPE#\u0026lt;recipe_id\u0026gt; SK: INGREDIENT#\u0026lt;number\u0026gt; Thuá»™c tÃ­nh: ingredient_name, quantity, unit Gá»£i Ã AI#\rPK: USER#\u0026lt;user_id\u0026gt; SK: SUGGESTION#\u0026lt;timestamp\u0026gt; Thuá»™c tÃ­nh: recipe_id, prompt_text, ai_response, was_accepted Lá»‹ch Sá»­ Náº¥u Ä‚n#\rPK: USER#\u0026lt;user_id\u0026gt; SK: COOKING#\u0026lt;timestamp\u0026gt;#\u0026lt;history_id\u0026gt; Thuá»™c tÃ­nh: recipe_id, status, personal_rating, is_favorite, cook_date GSI1PK: USER#\u0026lt;user_id\u0026gt;#FAVORITE (náº¿u is_favorite=true) GSI1SK: COOKING#\u0026lt;cook_date\u0026gt; ÄÃ¡nh GiÃ¡ CÃ´ng Thá»©c#\rPK: RECIPE#\u0026lt;recipe_id\u0026gt; SK: RATING#\u0026lt;user_id\u0026gt; Thuá»™c tÃ­nh: rating, comment, is_verified_cook, history_id GSI1PK: USER#\u0026lt;user_id\u0026gt; (ratings cá»§a user) GSI1SK: RATING#\u0026lt;created_at\u0026gt; Master Ingredients#\rPK: INGREDIENT#\u0026lt;ingredient_id\u0026gt; SK: METADATA Thuá»™c tÃ­nh: name, normalized_name, category, aliases GSI1PK: CATEGORY#\u0026lt;category\u0026gt; GSI1SK: INGREDIENT#\u0026lt;name\u0026gt; BÃ i ÄÄƒng (Posts)#\rPK: POST#\u0026lt;post_id\u0026gt; SK: METADATA Thuá»™c tÃ­nh: user_id, recipe_id, content, images, is_public, likes_count, comments_count GSI1PK: USER#\u0026lt;user_id\u0026gt; (bÃ i Ä‘Äƒng cá»§a ngÆ°á»i dÃ¹ng) GSI1SK: POST#\u0026lt;created_at\u0026gt; BÃ¬nh Luáº­n (Comments)#\rPK: POST#\u0026lt;post_id\u0026gt; SK: COMMENT#\u0026lt;timestamp\u0026gt;#\u0026lt;comment_id\u0026gt; Thuá»™c tÃ­nh: user_id, parent_comment_id, content GSI1PK: USER#\u0026lt;user_id\u0026gt; (bÃ¬nh luáº­n cá»§a ngÆ°á»i dÃ¹ng) GSI1SK: COMMENT#\u0026lt;timestamp\u0026gt; Reactions (LÆ°á»£t thÃ­ch)#\rPK: \u0026lt;target_type\u0026gt;#\u0026lt;target_id\u0026gt; (vÃ­ dá»¥: POST#123, RECIPE#456) SK: REACTION#\u0026lt;user_id\u0026gt; Thuá»™c tÃ­nh: reaction_type, created_at GSI1PK: USER#\u0026lt;user_id\u0026gt; (reactions cá»§a ngÆ°á»i dÃ¹ng) GSI1SK: REACTION#\u0026lt;created_at\u0026gt; ThÃ´ng BÃ¡o (Notifications)#\rPK: USER#\u0026lt;user_id\u0026gt; SK: NOTIFICATION#\u0026lt;timestamp\u0026gt;#\u0026lt;notification_id\u0026gt; Thuá»™c tÃ­nh: actor_id, type, target_type, target_id, content, is_read GSI1PK: USER#\u0026lt;user_id\u0026gt;#UNREAD (náº¿u is_read=false) GSI1SK: NOTIFICATION#\u0026lt;timestamp\u0026gt; Followers#\rPK: USER#\u0026lt;following_id\u0026gt; SK: FOLLOWER#\u0026lt;follower_id\u0026gt; Thuá»™c tÃ­nh: created_at GSI1PK: USER#\u0026lt;follower_id\u0026gt; (tra cá»©u ngÆ°á»£c - ai ngÆ°á»i nÃ y Ä‘ang follow) GSI1SK: FOLLOWING#\u0026lt;following_id\u0026gt; Chá»‰ Má»¥c Thá»© Cáº¥p ToÃ n Cá»¥c (GSI)#\rGSI1: Truy váº¥n dá»±a trÃªn ngÆ°á»i dÃ¹ng\nPK: GSI1PK (vÃ­ dá»¥: ROLE#admin, USER#\u0026lt;user_id\u0026gt;) SK: GSI1SK (vÃ­ dá»¥: timestamp, RECIPE#\u0026lt;created_at\u0026gt;) TrÆ°á»ng há»£p sá»­ dá»¥ng: Láº¥y táº¥t cáº£ quáº£n trá»‹ viÃªn Láº¥y cÃ´ng thá»©c cá»§a ngÆ°á»i dÃ¹ng sáº¯p xáº¿p theo ngÃ y Láº¥y quan há»‡ báº¡n bÃ¨ (tra cá»©u ngÆ°á»£c) Láº¥y bÃ i Ä‘Äƒng cá»§a ngÆ°á»i dÃ¹ng Láº¥y bÃ¬nh luáº­n cá»§a ngÆ°á»i dÃ¹ng Láº¥y reactions cá»§a ngÆ°á»i dÃ¹ng Láº¥y thÃ´ng bÃ¡o chÆ°a Ä‘á»c Láº¥y danh sÃ¡ch following GSI2: TÃ¬m kiáº¿m \u0026amp; khÃ¡m phÃ¡ cÃ´ng thá»©c (Enhanced)\nPK: GSI2PK (vÃ­ dá»¥: CUISINE#\u0026lt;type\u0026gt;, METHOD#\u0026lt;cooking_method\u0026gt;, MEALTYPE#\u0026lt;meal_type\u0026gt;) â­ SK: GSI2SK (vÃ­ dá»¥: RECIPE#\u0026lt;created_at\u0026gt;) TrÆ°á»ng há»£p sá»­ dá»¥ng: TÃ¬m kiáº¿m cÃ´ng thá»©c theo mÃ³n Äƒn TÃ¬m kiáº¿m cÃ´ng thá»©c theo phÆ°Æ¡ng phÃ¡p náº¥u (xÃ o, háº¥p, canh\u0026hellip;) â­ TÃ¬m kiáº¿m theo loáº¡i mÃ³n (mÃ³n chÃ­nh, mÃ³n phá»¥\u0026hellip;) â­ Láº¥y cÃ´ng thá»©c phá»• biáº¿n Diverse recipe suggestions â­ GSI3: Social Feed \u0026amp; Discovery\nPK: GSI3PK (vÃ­ dá»¥: FEED#\u0026lt;user_id\u0026gt;, PUBLIC) SK: GSI3SK (vÃ­ dá»¥: POST#\u0026lt;created_at\u0026gt;) TrÆ°á»ng há»£p sá»­ dá»¥ng: Láº¥y newsfeed (bÃ i Ä‘Äƒng cá»§a báº¡n bÃ¨) Láº¥y bÃ i Ä‘Äƒng cÃ´ng khai (explore feed) Láº¥y bÃ i Ä‘Äƒng trending Æ¯á»›c TÃ­nh Dung LÆ°á»£ng LÆ°u Trá»¯ \u0026amp; Chi PhÃ­#\rGiáº£ Äá»‹nh#\r1.000 ngÆ°á»i dÃ¹ng hoáº¡t Ä‘á»™ng Trung bÃ¬nh 20 nguyÃªn liá»‡u má»—i ngÆ°á»i dÃ¹ng Trung bÃ¬nh 5 cÃ´ng thá»©c Ä‘Ã£ lÆ°u má»—i ngÆ°á»i dÃ¹ng Trung bÃ¬nh 10 gá»£i Ã½ AI má»—i ngÆ°á»i dÃ¹ng má»—i thÃ¡ng Trung bÃ¬nh 10 bÃ i Ä‘Äƒng má»—i ngÆ°á»i dÃ¹ng Trung bÃ¬nh 30 bÃ¬nh luáº­n má»—i ngÆ°á»i dÃ¹ng Trung bÃ¬nh 100 reactions má»—i ngÆ°á»i dÃ¹ng Trung bÃ¬nh 50 thÃ´ng bÃ¡o má»—i ngÆ°á»i dÃ¹ng Trung bÃ¬nh 20 followers má»—i ngÆ°á»i dÃ¹ng Æ¯á»›c TÃ­nh Dung LÆ°á»£ng (Enhanced)#\rNgÆ°á»i dÃ¹ng (with preferences): 1.000 Ã— 1.2KB = 1.2MB NguyÃªn liá»‡u ngÆ°á»i dÃ¹ng: 1.000 Ã— 20 Ã— 0.5KB = 10MB Master ingredients: 5.000 Ã— 0.8KB = 4MB CÃ´ng thá»©c (with categories): 5.000 Ã— 5.5KB = 27.5MB â­ Lá»‹ch sá»­ náº¥u Äƒn: 1.000 Ã— 50 Ã— 0.8KB = 40MB ÄÃ¡nh giÃ¡ cÃ´ng thá»©c: 10.000 Ã— 0.5KB = 5MB Gá»£i Ã½ AI (enhanced): 10.000 Ã— 2.5KB = 25MB â­ Invalid reports (optional): 500 Ã— 0.5KB = 0.25MB â­ BÃ i Ä‘Äƒng: 10.000 Ã— 3KB = 30MB BÃ¬nh luáº­n: 30.000 Ã— 0.5KB = 15MB Reactions: 100.000 Ã— 0.2KB = 20MB ThÃ´ng bÃ¡o: 50.000 Ã— 0.5KB = 25MB Followers: 20.000 Ã— 0.3KB = 6MB Tá»•ng cá»™ng: ~209MB Chi PhÃ­ DynamoDB (HÃ ng ThÃ¡ng) - Enhanced#\rLÆ°u trá»¯: 209MB Ã— $0.25/GB = ~$0.05 Kháº£ nÄƒng Ä‘á»c: ~$15-20 (tÄƒng do category queries) â­ Kháº£ nÄƒng ghi: ~$15-20 (tÄƒng do invalid logging, enhanced suggestions) â­ GSI (4 indexes): ~$10-15 (tÄƒng do GSI2 category index) â­ Tá»•ng cá»™ng: ~$40-55/thÃ¡ng (vs $32-48 trÆ°á»›c Ä‘Ã³) "},{"id":4,"href":"/docs/summary/cost-analysis/","title":"PhÃ¢n TÃ­ch Chi PhÃ­","section":"Summary","content":"PHÃ‚N TÃCH CHI PHÃ Dá»° ÃN#\rğŸ’° Chi PhÃ­ HÃ ng ThÃ¡ng (1,000 users) - ENHANCED#\rDá»‹ch Vá»¥ Chi PhÃ­ Æ¯á»›c TÃ­nh Ghi ChÃº AWS Amplify $15 Hosting Next.js + CI/CD Amazon CloudFront $8 CDN, 1TB data transfer Amazon API Gateway $10 ~180K requests/thÃ¡ng AWS Lambda Functions $25 11 Lambda functions Amazon Bedrock (Flexible) $12-30 FLEXIBLE mix (60% DB coverage) â­ Amazon DynamoDB $45 On-demand vá»›i categories, invalid reports â­ Amazon S3 $10 100GB storage Amazon Cognito FREE \u0026lt; 50,000 MAU Amazon CloudWatch $12 Enhanced logging vá»›i invalid ingredients â­ AWS WAF $6 Web Application Firewall AWS Secrets Manager $2 API keys storage Tá»•ng Chi PhÃ­ (Enhanced)#\rKá»‹ch Báº£n Chi PhÃ­/ThÃ¡ng Note Best Case (DB Ä‘á»§ 80%) ~$135 Tiáº¿t kiá»‡m AI âœ… Average Case (DB 60%) ~$150 Recommended âœ… Worst Case (DB rá»—ng) ~$180 Cold start ğŸ’¡ Khuyáº¿n nghá»‹:\nSá»­ dá»¥ng Claude 3 Haiku Flexible mix tá»± Ä‘á»™ng tiáº¿t kiá»‡m cost khi DB Ä‘á»§ Average stable cost: $150/thÃ¡ng (vs $168 fixed trÆ°á»›c Ä‘Ã³) ğŸ“Š PhÃ¢n TÃ­ch Chi PhÃ­ Theo Quy MÃ´ (Enhanced)#\rKá»‹ch Báº£n 1: MVP (1,000 users)#\rChi phÃ­: $135-180/thÃ¡ng (flexible based on DB coverage) Chi phÃ­/user: $0.135-0.180/thÃ¡ng Doanh thu cáº§n: $450-600/thÃ¡ng (ROI 3-4x) Ká»‹ch Báº£n 2: TÄƒng TrÆ°á»Ÿng (10,000 users)#\rChi phÃ­: $380-500/thÃ¡ng Chi phÃ­/user: $0.038-0.050/thÃ¡ng Doanh thu cáº§n: $1,500-2,000/thÃ¡ng Ká»‹ch Báº£n 3: Scale (100,000 users)#\rChi phÃ­: $2,000-2,800/thÃ¡ng Chi phÃ­/user: $0.020-0.028/thÃ¡ng Doanh thu cáº§n: $8,000-11,000/thÃ¡ng ğŸ’¡ Chiáº¿n LÆ°á»£c Tá»‘i Æ¯u Chi PhÃ­#\r1. AI/ML Costs (40-50% tá»•ng chi phÃ­) - ENHANCED â­#\râœ… Flexible DB/AI Mix â†’ Tiáº¿t kiá»‡m 30-70% tÃ¹y DB coverage â­ âœ… Sá»­ dá»¥ng Claude 3 Haiku thay vÃ¬ Sonnet â†’ Tiáº¿t kiá»‡m 70% âœ… Auto-build DB tá»« popular AI recipes â†’ DB coverage tÄƒng tá»« 0% â†’ 80% â­ âœ… Cache AI responses â†’ Giáº£m 20-30% duplicate calls âœ… Prompt optimization â†’ Giáº£m token usage 15% âœ… Rate limiting \u0026amp; Freemium tiers â†’ Control abuse â­ Tiáº¿t kiá»‡m Æ°á»›c tÃ­nh: $50-80/thÃ¡ng (vs $40-50 trÆ°á»›c Ä‘Ã³)\n2. Database Costs (25-30% tá»•ng chi phÃ­)#\râœ… DynamoDB on-demand â†’ Chá»‰ tráº£ khi sá»­ dá»¥ng âœ… TTL cho old AI suggestions â†’ Giáº£m storage âœ… TTL cho old cooking history â†’ Tá»± Ä‘á»™ng xÃ³a sau 1 nÄƒm (optional) âœ… Batch operations â†’ Giáº£m write units âœ… Compression cho JSON fields â†’ Giáº£m storage 30% âœ… Optimize GSI usage â†’ Giáº£m chi phÃ­ index cho social features âœ… Cache master_ingredients â†’ Giáº£m read operations cho validation Tiáº¿t kiá»‡m Æ°á»›c tÃ­nh: $10-15/thÃ¡ng\n3. CDN \u0026amp; Hosting (15-20% tá»•ng chi phÃ­)#\râœ… CloudFront caching â†’ Giáº£m origin requests âœ… Image optimization â†’ Giáº£m bandwidth âœ… Gzip compression â†’ Giáº£m 60% transfer size âœ… Lazy loading â†’ Giáº£m initial load Tiáº¿t kiá»‡m Æ°á»›c tÃ­nh: $5-8/thÃ¡ng\n4. Lambda Costs (12-15% tá»•ng chi phÃ­)#\râœ… Reserved concurrency â†’ NgÄƒn runaway costs âœ… Memory optimization â†’ Giáº£m execution cost âœ… Connection pooling â†’ Giáº£m cold starts âœ… Code minification â†’ Giáº£m package size âœ… Optimize Posts/Notifications Lambda â†’ Batch processing âœ… Optimize Cooking History Lambda â†’ Minimal compute âœ… Optimize Rating Lambda â†’ Efficient calculation logic Tiáº¿t kiá»‡m Æ°á»›c tÃ­nh: $5-8/thÃ¡ng\n5. Storage Costs (8-10% tá»•ng chi phÃ­)#\râœ… S3 Intelligent-Tiering â†’ Auto-optimize âœ… Lifecycle policies â†’ XÃ³a temp files sau 90 ngÃ y âœ… Image compression â†’ WebP format âœ… Thumbnail generation â†’ Giáº£m storage âœ… Posts image optimization â†’ Compress trÆ°á»›c khi upload Tiáº¿t kiá»‡m Æ°á»›c tÃ­nh: $3-5/thÃ¡ng\nğŸ“ˆ Chi PhÃ­ Dá»± Kiáº¿n Theo Thá»i Gian#\rNÄƒm 1#\rThÃ¡ng Users Chi PhÃ­ Revenue Target 1-3 100 $90 $280 (Beta) 4-6 500 $110 $400 7-9 1,500 $145 $550 10-12 3,000 $200 $750 NÄƒm 2#\rQuarter Users Chi PhÃ­ Revenue Target Q1 5,000 $250 $1,100 Q2 8,000 $320 $1,600 Q3 12,000 $400 $2,400 Q4 20,000 $580 $3,800 ğŸ¯ Break-Even Analysis#\rMÃ´ HÃ¬nh Freemium#\rFree tier: Giá»›i háº¡n 10 AI suggestions/thÃ¡ng Premium tier: $4.99/thÃ¡ng (unlimited) Conversion rate target: 5% ThÃ¡ng 1-3 (1,000 users)#\rPremium users: 50 (5%) Revenue: $250/thÃ¡ng Cost: $133/thÃ¡ng Profit: $117/thÃ¡ng âœ… ThÃ¡ng 12 (10,000 users)#\rPremium users: 500 (5%) Revenue: $2,500/thÃ¡ng Cost: $400/thÃ¡ng Profit: $2,100/thÃ¡ng âœ… MÃ´ HÃ¬nh Ads (Alternative)#\rAd revenue: $0.50-1.00/user/thÃ¡ng 1,000 users = $500-1,000/thÃ¡ng Cost: $133/thÃ¡ng Profit: $367-867/thÃ¡ng âœ… ğŸ”’ Chi PhÃ­ Báº£o Máº­t \u0026amp; Compliance#\rItem Chi PhÃ­/ThÃ¡ng AWS WAF $6 AWS Secrets Manager $2 SSL/TLS Certificates FREE (ACM) DDoS Protection (Shield Standard) FREE Encryption at Rest FREE CloudWatch Alarms $1 Total $9 ğŸš€ Chi PhÃ­ TÄƒng TrÆ°á»Ÿng Dá»± Kiáº¿n#\rMarketing \u0026amp; Growth (NgoÃ i AWS)#\rMarketing: $500-1,000/thÃ¡ng (Facebook Ads, Google Ads) Support: $200-500/thÃ¡ng (Zendesk/Intercom) Analytics: $50-100/thÃ¡ng (Mixpanel/Amplitude) Payment Processing: 2.9% + $0.30/transaction (Stripe) Total Operating Costs (ThÃ¡ng 12)#\rAWS Infrastructure: $200 Marketing: $800 Support: $300 Analytics: $75 Payment Processing: $75 (3% Ã— $2,500) Total: $1,450/thÃ¡ng ğŸ“Š ROI Projection#\rYear 1#\rTotal Investment: $10,000 (dev) + $1,800 (AWS) = $11,800 Revenue Year 1: $20,000 (average $1,667/thÃ¡ng) ROI: 70% âœ… Year 2#\rTotal Investment: $5,000 (maintenance) + $4,000 (AWS) Revenue Year 2: $70,000 (average $5,833/thÃ¡ng) ROI: 680% âœ…âœ… ğŸ’° Khuyáº¿n Nghá»‹ Cuá»‘i CÃ¹ng#\rGiai Äoáº¡n MVP (0-3 thÃ¡ng) - ENHANCED#\râœ… Sá»­ dá»¥ng Claude 3 Haiku âœ… Implement Flexible DB/AI mix â­ âœ… Enable CloudFront caching âœ… Set billing alarms táº¡i $140, $170, $200 â­ âœ… Freemium tier: Free (1 mÃ³n), Premium (5 mÃ³n) â­ âœ… Cache master_ingredients in-memory âœ… Simple invalid logging (CloudWatch only) âœ… Category-based diverse suggestions â­ Chi phÃ­ target: $135-160/thÃ¡ng (vs $90-130 MVP basic)\nGiai Äoáº¡n Growth (4-12 thÃ¡ng) - ENHANCED#\râœ… Monitor DB coverage % growth â†’ Target 60-80% â­ âœ… Auto-approve popular AI recipes â†’ Build DB automatically â­ âœ… Scale DynamoDB capacity dáº§n dáº§n âœ… Consider Reserved Instances khi stable âœ… Implement advanced caching strategies âœ… Optimize category distribution in AI suggestions â­ âœ… Full invalid reporting system vá»›i admin dashboard â­ âœ… TTL policies cho cooking history (optional) Chi phÃ­ target: $150-400/thÃ¡ng (giáº£m dáº§n khi DB tÄƒng)\nGiai Äoáº¡n Scale (Year 2+)#\râœ… Negotiate Enterprise Pricing vá»›i AWS âœ… Consider Savings Plans (20-40% discount) âœ… Optimize architecture dá»±a trÃªn real data âœ… Automate cost monitoring \u0026amp; alerts Chi phÃ­ target: \u0026lt; $0.02/user/thÃ¡ng\n"}]